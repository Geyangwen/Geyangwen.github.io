<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="标签: mysql, 小文同学">
    <meta name="description" content="你的征途是星辰大海，怎么能被眼前的挫折打败。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>标签: mysql | 小文同学</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="小文同学" type="application/atom+xml">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="./images/loading.gif" data-original="https://blog-accelerated.oss-cn-hangzhou.aliyuncs.com/source/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">小文同学</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">

      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a target="_blank" rel="noopener" href="https://www.kugou.com/">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>酷狗音乐</span>
        </a>
      </li>
      
      <li>
        <a target="_blank" rel="noopener" href="https://search.bilibili.com/">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>哔哩哔哩</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="./images/loading.gif" data-original="https://blog-accelerated.oss-cn-hangzhou.aliyuncs.com/source/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">小文同学</div>
        <div class="logo-desc">
            
            你的征途是星辰大海，怎么能被眼前的挫折打败。
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-address-book"></i>
			
			友情链接
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a target="_blank" rel="noopener" href="https://www.kugou.com/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>酷狗音乐</span>
                  </a>
                </li>
              
                <li>

                  <a target="_blank" rel="noopener" href="https://search.bilibili.com/ " style="margin-left:75px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>哔哩哔哩</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/Geyangwen/Geyangwen.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/Geyangwen/Geyangwen.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://blog-accelerated.oss-cn-hangzhou.aliyuncs.com/source/medias/featureimages/10.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">mysql学习笔记初级</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/mysql/">
                                <span class="chip bg-color">mysql</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/mysql%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-category">
                                mysql学习笔记
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-11-02
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    17.4k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    75 分
                </div>
                

                
                    <span id="busuanzi_container_site_pv" style='display:none'></span>
                    <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                    <span id="busuanzi_value_page_pv" ></span>
            
            
            
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="第一章-数据库的基本概念"><a href="#第一章-数据库的基本概念" class="headerlink" title="第一章  数据库的基本概念"></a>第一章  数据库的基本概念</h1><h2 id="1-数据库的好处"><a href="#1-数据库的好处" class="headerlink" title="1. 数据库的好处"></a><strong>1. 数据库的好处</strong></h2><p>1.可以持久化数据到本地</p>
<p>2.结构化查询</p>
<h2 id="2-数据库的常见概念"><a href="#2-数据库的常见概念" class="headerlink" title="2.数据库的常见概念"></a><strong>2.数据库的常见概念</strong></h2><p>DB:数据库，存储数据库的容器</p>
<p>DBMS:数据库管理系统，又称数据库软件或数据库产品，用于创建或管理DB</p>
<p>SQL:结构化查询语言，用于和数据库通信的语言，不是数据库软件特有的，而是几乎所有的主流数据库软件通用的语言</p>
<h2 id="3-数据库存储数据的特点"><a href="#3-数据库存储数据的特点" class="headerlink" title="3. 数据库存储数据的特点"></a>3. <strong>数据库存储数据的特点</strong></h2><p>数据存放在表中，然后表再放到库中</p>
<p>一个库中可以有多张表，每张表具有唯一的表名用来标识自己</p>
<p>表中有一个或多个列，列又称为“字段”，相当于java中的属性</p>
<p>表中的每一行数据，相当于java中的对象。</p>
<h2 id="4-常见的数据库管理系统"><a href="#4-常见的数据库管理系统" class="headerlink" title="4.常见的数据库管理系统"></a><strong>4.常见的数据库管理系统</strong></h2><p>Mysql  wracle  db2  sqlserver</p>
<h2 id="5-MySQL的优点"><a href="#5-MySQL的优点" class="headerlink" title="5.MySQL的优点"></a><strong>5.MySQL的优点</strong></h2><p>1、开源、免费、成本低</p>
<p>2、性能高、移植性也好</p>
<p>3、体积小，便于安装</p>
<h2 id="6-MySQL的安装"><a href="#6-MySQL的安装" class="headerlink" title="6.MySQL的安装"></a><strong>6.MySQL的安装</strong></h2><p><strong>属于c/s架构的软件，一般来讲安装服务端</strong></p>
<p><strong>企业版</strong></p>
<p><strong>社区版****5.5、5.6、5.7、8.0</strong></p>
<h2 id="7-MySQL服务的启动和停止"><a href="#7-MySQL服务的启动和停止" class="headerlink" title="7.MySQL服务的启动和停止"></a><strong>7.MySQL服务的启动和停止</strong></h2><p><strong>方式一：通过命令行</strong></p>
<p>​	<strong>net start 服务名</strong></p>
<p>​	<strong>net stop 服务名</strong></p>
<p><strong>方式二：计算机——右击——管理——服务</strong></p>
<h2 id="8-MySQL服务的登录和退出"><a href="#8-MySQL服务的登录和退出" class="headerlink" title="8.MySQL服务的登录和退出"></a><strong>8.MySQL服务的登录和退出</strong></h2><p><strong>登录：mysql 【-h 主机名 -P 端口号】 -u 用户名 -p密码</strong></p>
<p><strong>退出：exit或ctrl+C</strong></p>
<h1 id="第二章-DQL查询语句"><a href="#第二章-DQL查询语句" class="headerlink" title="第二章 DQL查询语句"></a>第二章 DQL查询语句</h1><h2 id="进阶1：基础查询"><a href="#进阶1：基础查询" class="headerlink" title="进阶1：基础查询"></a><strong>进阶1：基础查询</strong></h2><h3 id="一、语法"><a href="#一、语法" class="headerlink" title="一、语法"></a><strong>一、语法</strong></h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 查询列表
<span class="token keyword">from</span> 表名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="二、特点"><a href="#二、特点" class="headerlink" title="二、特点"></a>二、特点</h3><p>1、查询列表可以是<strong>字段、常量、表达式、函数，也可以是多个</strong></p>
<p>2、查询结果是一个虚拟表</p>
<h3 id="三、示例"><a href="#三、示例" class="headerlink" title="三、示例"></a>三、示例</h3><h4 id="1、查询单个字段"><a href="#1、查询单个字段" class="headerlink" title="1、查询单个字段"></a>1、查询单个字段</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 字段名 <span class="token keyword">from</span> 表名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="2、查询多个字段"><a href="#2、查询多个字段" class="headerlink" title="2、查询多个字段"></a>2、查询多个字段</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 字段名，字段名 <span class="token keyword">from</span> 表名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="3、查询所有字段"><a href="#3、查询所有字段" class="headerlink" title="3、查询所有字段"></a>3、查询所有字段</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> 表名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="4、查询常量"><a href="#4、查询常量" class="headerlink" title="4、查询常量"></a>4、查询常量</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 常量值<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>注意：</strong>字符型和日期型的常量值必须用单引号引起来，数值型不需要</p>
<h4 id="5、查询函数"><a href="#5、查询函数" class="headerlink" title="5、查询函数"></a>5、查询函数</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 函数名<span class="token punctuation">(</span>实参列表<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="6、查询表达式"><a href="#6、查询表达式" class="headerlink" title="6、查询表达式"></a>6、查询表达式</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token number">100</span><span class="token operator">/</span><span class="token number">1234</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="7、起别名"><a href="#7、起别名" class="headerlink" title="7、起别名"></a>7、起别名</h4><p>①as</p>
<p>②空格</p>
<h4 id="8、去重"><a href="#8、去重" class="headerlink" title="8、去重"></a>8、去重</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">distinct</span> 字段名 <span class="token keyword">from</span> 表名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="9、"><a href="#9、" class="headerlink" title="9、+"></a>9、+</h4><p>作用：做加法运算</p>
<p>select 数值+数值; 直接运算</p>
<p>select 字符+数值;先试图将字符转换成数值，如果转换成功，则继续运算；否则转换成0，再做运算</p>
<p>select null+值;结果都为null</p>
<h4 id="10、【补充】concat函数"><a href="#10、【补充】concat函数" class="headerlink" title="10、【补充】concat函数"></a>10、【补充】concat函数</h4><p>功能：拼接字符</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> concat<span class="token punctuation">(</span>字符<span class="token number">1</span>，字符<span class="token number">2</span>，字符<span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h4 id="11、【补充】ifnull函数"><a href="#11、【补充】ifnull函数" class="headerlink" title="11、【补充】ifnull函数"></a>11、【补充】ifnull函数</h4><p>功能：判断某字段或表达式是否为null，如果为null 返回指定的值，否则返回原本的值</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> ifnull<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">from</span> employees<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h4 id="12、【补充】isnull函数"><a href="#12、【补充】isnull函数" class="headerlink" title="12、【补充】isnull函数"></a>12、【补充】isnull函数</h4><p>功能：判断某字段或表达式是否为null，如果是，则返回1，否则返回0</p>
<p>例如：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> isnull<span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span>commission_pct <span class="token keyword">from</span> employees<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h3 id="四、代码示例如下："><a href="#四、代码示例如下：" class="headerlink" title="四、代码示例如下："></a>四、代码示例如下：</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/*
语法：
select 查询列表 from 表名;
类似于：System.out.println(打印东西);
特点：
1、查询列表可以是：表中的字段、常量值、表达式、函数
2、查询的结果是一个虚拟的表格
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">USE</span> myemployees<span class="token punctuation">;</span>

<span class="token comment">#1.查询表中的单个字段</span>
<span class="token keyword">SELECT</span> last_name <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#2.查询表中的多个字段</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>email <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#3.查询表中的所有字段</span>
<span class="token comment">#方式一：</span>
<span class="token keyword">SELECT</span> 
  <span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>first_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>last_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>phone_number<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>last_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>phone_number<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>commission_pct<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>hiredate<span class="token punctuation">`</span></span> 
<span class="token keyword">FROM</span>
  employees <span class="token punctuation">;</span>

<span class="token comment">#方式二：  </span>
 <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#4.查询常量值</span>
 <span class="token keyword">SELECT</span> <span class="token number">100</span><span class="token punctuation">;</span>
 <span class="token keyword">SELECT</span> <span class="token string">'john'</span><span class="token punctuation">;</span>
 
<span class="token comment">#5.查询表达式</span>
 <span class="token keyword">SELECT</span> <span class="token number">100</span><span class="token operator">%</span><span class="token number">98</span><span class="token punctuation">;</span>

<span class="token comment">#6.查询函数</span>
<span class="token keyword">SELECT</span> VERSION<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#7.起别名</span>
 <span class="token comment">/*
 ①便于理解
 ②如果要查询的字段有重名的情况，使用别名可以区分开来
 */</span>

<span class="token comment">#方式一：使用as</span>
<span class="token keyword">SELECT</span> <span class="token number">100</span><span class="token operator">%</span><span class="token number">98</span> <span class="token keyword">AS</span> 结果<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> last_name <span class="token keyword">AS</span> 姓<span class="token punctuation">,</span>first_name <span class="token keyword">AS</span> 名 <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment">#方式二：使用空格</span>
<span class="token keyword">SELECT</span> last_name 姓<span class="token punctuation">,</span>first_name 名 <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#案例：查询salary，显示结果为 out put</span>
<span class="token keyword">SELECT</span> salary <span class="token keyword">AS</span> <span class="token string">"out put"</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
 
<span class="token comment">#8.去除重复</span>
<span class="token comment">#案例：查询员工表中涉及到的所有的部门编号</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> department_id <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#9.+号的作用</span>
<span class="token comment">/*
java中的+号：
①运算符，两个操作数都为数值型
②连接符，只要有一个操作数为字符串

mysql中的+号：
仅仅只有一个功能：运算符

select 100+90; 两个操作数都为数值型，则做加法运算
select '123'+90;只要其中一方为字符型，试图将字符型数值转换成数值型。如果转换成功，则继续做加法运算
select 'john'+90;  如果转换失败，则将字符型数值转换成0
select null+10; 只要其中一方为null，则结果肯定为null
*/</span>

<span class="token comment">#案例：查询员工名和姓连接成一个字段，并显示为 姓名</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 结果<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> 
  CONCAT<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span>first_name<span class="token punctuation">)</span> <span class="token keyword">AS</span> 姓名
<span class="token keyword">FROM</span>
  employees<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="进阶2：条件查询"><a href="#进阶2：条件查询" class="headerlink" title="进阶2：条件查询"></a><strong>进阶2：条件查询</strong></h2><h3 id="一、语法-1"><a href="#一、语法-1" class="headerlink" title="一、语法"></a>一、语法</h3><h4 id="1、简单条件运算符"><a href="#1、简单条件运算符" class="headerlink" title="1、简单条件运算符"></a>1、简单条件运算符</h4><p>&gt;		&lt; 		= 		&lt;&gt;(不等于)		!= 		&gt;=		 &lt;= 		 &lt;=&gt;（安全等于）</p>
<h4 id="2、逻辑运算符"><a href="#2、逻辑运算符" class="headerlink" title="2、逻辑运算符"></a>2、逻辑运算符</h4><p>&amp;&amp; 			and</p>
<p>||	 			or</p>
<p>!  				not</p>
<h4 id="3、模糊查询"><a href="#3、模糊查询" class="headerlink" title="3、模糊查询"></a>3、模糊查询</h4><p><strong>like:<strong>一般搭配通配符使用，可以判断</strong>字符型或数值型</strong>  字符要用’’  如：**’%a%’**</p>
<p>通配符：**%任意多个字符，包含0个字符**， 		 <strong>_任意单个字符</strong></p>
<p>如果需要查的字符有_   可以使用\转义，	推荐使用ESCAPE 	 ‘<em>$</em>%’ ESCAPE <em>$</em></p>
<p><strong>between and</strong>  可以  between 100  and 200  表示100-120之间包含100,120</p>
<p><strong>in</strong>       in(‘字段1’,’字段2’,’字段3’)  简单一些  其中字段需要一致或兼容</p>
<p><strong>is null /is not null</strong>：用于判断null值</p>
<p><strong>is null  	PK	 &lt;=&gt;（安全等于）</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">普通类型的数值</th>
<th align="center">null值</th>
<th align="center">可读性</th>
</tr>
</thead>
<tbody><tr>
<td align="center">is null</td>
<td align="center">×</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">&lt;=&gt;</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">×</td>
</tr>
</tbody></table>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">*</span>
语法：
  <span class="token keyword">select</span> 
    查询列表
  <span class="token keyword">from</span>
    表名
  <span class="token keyword">where</span>
    筛选条件<span class="token punctuation">;</span>

筛选条件分类：
  一、按条件表达式筛选
    简单条件运算符：<span class="token operator">&gt;</span> <span class="token operator">&lt;</span> <span class="token operator">=</span> <span class="token operator">!=</span> <span class="token operator">&lt;&gt;</span> <span class="token operator">&gt;=</span> <span class="token operator">&lt;=</span>

  二、按逻辑表达式筛选
  逻辑运算符：
  作用：用于连接条件表达式
    <span class="token operator">&amp;&amp;</span> <span class="token operator">||</span> <span class="token operator">!</span>
    <span class="token operator">and</span> <span class="token operator">or</span> <span class="token operator">not</span>
  <span class="token operator">&amp;&amp;</span>和<span class="token operator">and</span>：两个条件都为<span class="token boolean">true</span>，结果为<span class="token boolean">true</span>，反之为<span class="token boolean">false</span>
  <span class="token operator">||</span>或<span class="token operator">or</span>： 只要有一个条件为<span class="token boolean">true</span>，结果为<span class="token boolean">true</span>，反之为<span class="token boolean">false</span>
  <span class="token operator">!</span>或<span class="token operator">not</span>： 如果连接的条件本身为<span class="token boolean">false</span>，结果为<span class="token boolean">true</span>，反之为<span class="token boolean">false</span>
  
  三、模糊查询
    <span class="token operator">like</span>
    <span class="token operator">between</span> <span class="token operator">and</span>
    <span class="token operator">in</span>
    <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token operator">*</span><span class="token operator">/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="二、案列如下："><a href="#二、案列如下：" class="headerlink" title="二、案列如下："></a><strong>二、案列如下：</strong></h3><h4 id="一、按条件表达式筛选"><a href="#一、按条件表达式筛选" class="headerlink" title="一、按条件表达式筛选"></a>一、按条件表达式筛选</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：查询工资&gt;12000的员工信息</span>
<span class="token keyword">SELECT</span> 
  <span class="token operator">*</span>
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  salary<span class="token operator">&gt;</span><span class="token number">12000</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：查询部门编号不等于90号的员工名和部门编号</span>
<span class="token keyword">SELECT</span> 
  last_name<span class="token punctuation">,</span>
  department_id
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  department_id<span class="token operator">&lt;&gt;</span><span class="token number">90</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="二、按逻辑表达式筛选"><a href="#二、按逻辑表达式筛选" class="headerlink" title="二、按逻辑表达式筛选"></a>二、按逻辑表达式筛选</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：查询工资z在10000到20000之间的员工名、工资以及奖金</span>
<span class="token keyword">SELECT</span>
  last_name<span class="token punctuation">,</span>
  salary<span class="token punctuation">,</span>
  commission_pct
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  salary<span class="token operator">&gt;=</span><span class="token number">10000</span> <span class="token operator">AND</span> salary<span class="token operator">&lt;=</span><span class="token number">20000</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：查询部门编号不是在90到110之间，或者工资高于15000的员工信息</span>
<span class="token keyword">SELECT</span>
  <span class="token operator">*</span>
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  <span class="token operator">NOT</span><span class="token punctuation">(</span>department_id<span class="token operator">&gt;=</span><span class="token number">90</span> <span class="token operator">AND</span> department_id<span class="token operator">&lt;=</span><span class="token number">110</span><span class="token punctuation">)</span> <span class="token operator">OR</span> salary<span class="token operator">&gt;</span><span class="token number">15000</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="三、模糊查询"><a href="#三、模糊查询" class="headerlink" title="三、模糊查询"></a>三、模糊查询</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">/*
like
between and
in
is null|is not null
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#1.like</span>
<span class="token comment">/*
特点：
①一般和通配符搭配使用
  通配符：
  % 任意多个字符,包含0个字符
  _ 任意单个字符 */</span>

<span class="token comment">#案例1：查询员工名中包含字符a的员工信息</span>
<span class="token keyword">select</span> 
  <span class="token operator">*</span>
<span class="token keyword">from</span>
  employees
<span class="token keyword">where</span>
  last_name <span class="token operator">like</span> <span class="token string">'%a%'</span><span class="token punctuation">;</span>		<span class="token comment">#abc  （%是通配符）</span>

<span class="token comment">#案例2：查询员工名中第三个字符为n，第五个字符为l的员工名和工资</span>
<span class="token keyword">select</span>
  last_name<span class="token punctuation">,</span>
  salary
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
last_name <span class="token operator">LIKE</span> <span class="token string">'__n_l%'</span><span class="token punctuation">;</span>
 
<span class="token comment">#案例3：查询员工名中第二个字符为_的员工名</span>
<span class="token keyword">SELECT</span>
  last_name
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  last_name <span class="token operator">LIKE</span> <span class="token string">'_$_%'</span> <span class="token keyword">ESCAPE</span> <span class="token string">'$'</span><span class="token punctuation">;</span>   <span class="token comment">// $——可以表示为转义字符</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#2.between and</span>
<span class="token comment">/*
①使用between and 可以提高语句的简洁度
②包含临界值
③两个临界值不要调换顺序
*/</span>

<span class="token comment">#案例1：查询员工编号在100到120之间的员工信息</span>
<span class="token keyword">SELECT</span>
  <span class="token operator">*</span>
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  employee_id <span class="token operator">&gt;=</span> <span class="token number">100</span> <span class="token operator">AND</span> employee_id<span class="token operator">&lt;=</span><span class="token number">120</span><span class="token punctuation">;</span>

<span class="token comment">#----------------------</span>
<span class="token keyword">SELECT</span>
  <span class="token operator">*</span>
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  employee_id <span class="token operator">BETWEEN</span> <span class="token number">100</span> <span class="token operator">AND</span> <span class="token number">120</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#3.in</span>
<span class="token comment">/*
含义：判断某字段的值是否属于in列表中的某一项
特点：
  ①使用in提高语句简洁度
  ②in列表的值类型必须一致或兼容
  ③in列表中不支持通配符
*/</span>

<span class="token comment">#案例：查询员工的工种编号是 IT_PROG、AD_VP、AD_PRES中的一个员工名和工种编号</span>
<span class="token keyword">SELECT</span>
  last_name<span class="token punctuation">,</span>
  job_id
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  job_id <span class="token operator">=</span> <span class="token string">'IT_PROT'</span> <span class="token operator">OR</span> job_id <span class="token operator">=</span> <span class="token string">'AD_VP'</span> <span class="token operator">OR</span> JOB_ID <span class="token operator">=</span><span class="token string">'AD_PRES'</span><span class="token punctuation">;</span>

\#<span class="token comment">------------------</span>
<span class="token keyword">SELECT</span>
  last_name<span class="token punctuation">,</span>
  job_id
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  job_id <span class="token operator">IN</span><span class="token punctuation">(</span> <span class="token string">'IT_PROT'</span> <span class="token punctuation">,</span><span class="token string">'AD_VP'</span><span class="token punctuation">,</span><span class="token string">'AD_PRES'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#4、is null</span>
<span class="token comment">/*
=或&lt;&gt;不能用于判断null值
is null或is not null 可以判断null值
*/</span>

\#案例<span class="token number">1</span>：查询没有奖金的员工名和奖金率
<span class="token keyword">SELECT</span>
  last_name<span class="token punctuation">,</span>
  commission_pct
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  commission_pct <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

\#案例<span class="token number">1</span>：查询有奖金的员工名和奖金率
<span class="token keyword">SELECT</span>
  last_name<span class="token punctuation">,</span>
  commission_pct
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">#----------以下为×</span>
<span class="token comment">#----------以下为×</span>
<span class="token comment">#----------以下为×</span>
<span class="token keyword">SELECT</span>
  last_name<span class="token punctuation">,</span>
  commission_pct
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span> 
  salary <span class="token operator">IS</span> <span class="token number">12000</span><span class="token punctuation">;</span>  

 
<span class="token comment">#安全等于  &lt;=&gt;</span>
<span class="token comment">#案例1：查询没有奖金的员工名和奖金率</span>
<span class="token keyword">SELECT</span>
  last_name<span class="token punctuation">,</span>
  commission_pct
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span>
  commission_pct <span class="token operator">&lt;=&gt;</span><span class="token boolean">NULL</span><span class="token punctuation">;</span>

\#案例<span class="token number">2</span>：查询工资为<span class="token number">12000</span>的员工信息
<span class="token keyword">SELECT</span>
  last_name<span class="token punctuation">,</span>
  salary
<span class="token keyword">FROM</span>
  employees
<span class="token keyword">WHERE</span> 
  salary <span class="token operator">&lt;=&gt;</span> <span class="token number">12000</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> #is null 		pk 		&lt;=&gt;</p>
<p><strong>IS NULL</strong>:		仅仅可以判断NULL值，可读性较高，建议使用</p>
<p><strong>&lt;=&gt;</strong>  	  :		既可以判断NULL值，又可以判断普通的数值，可读性较低</p>
<h2 id="进阶3：排序查询"><a href="#进阶3：排序查询" class="headerlink" title="进阶3：排序查询"></a><strong>进阶3：排序查询</strong></h2><h3 id="一、语法-2"><a href="#一、语法-2" class="headerlink" title="一、语法"></a><strong>一、语法</strong></h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 查询列表
<span class="token keyword">from</span> 表
<span class="token keyword">where</span> 筛选条件
<span class="token keyword">order</span> <span class="token keyword">by</span> 排序列表 【<span class="token keyword">asc</span> <span class="token operator">|</span> <span class="token keyword">desc</span>】<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="二、特点-1"><a href="#二、特点-1" class="headerlink" title="二、特点"></a>二、特点</h3><p>1、asc ：升序，如果不写默认升序</p>
<pre><code>  desc：降序
</code></pre>
<p>2、排序列表 支持 单个字段、多个字段、函数、表达式、别名</p>
<p>3、order by的位置一般放在查询语句的最后（除limit语句之外）</p>
<h3 id="三、案列"><a href="#三、案列" class="headerlink" title="三、案列"></a><strong>三、案列</strong></h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#1、按单个字段排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">#2、添加筛选条件再排序</span>
<span class="token comment">#案例：查询部门编号&gt;=90的员工信息，并按员工编号降序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> department_id<span class="token operator">&gt;=</span><span class="token number">90</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> employee_id <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">#3、按表达式排序</span>
<span class="token comment">#案例：查询员工信息 按年薪降序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>salary<span class="token operator">*</span><span class="token number">12</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary<span class="token operator">*</span><span class="token number">12</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">#4、按别名排序</span>
<span class="token comment">#案例：查询员工信息 按年薪升序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>salary<span class="token operator">*</span><span class="token number">12</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 年薪
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 年薪 <span class="token keyword">ASC</span><span class="token punctuation">;</span>

<span class="token comment">#5、按函数排序</span>
<span class="token comment">#案例：查询员工名，并且按名字的长度降序 LENGTH(last_name)返回字符串长度</span>
<span class="token keyword">SELECT</span> LENGTH<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">,</span>last_name 
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> LENGTH<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">#6、按多个字段排序</span>
<span class="token comment">#案例：查询员工信息，要求先按工资降序，再按employee_id升序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span><span class="token punctuation">,</span>employee_id <span class="token keyword">ASC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="进阶4：常见函数"><a href="#进阶4：常见函数" class="headerlink" title="进阶4：常见函数"></a><strong>进阶4：常见函数</strong></h2><h3 id="一、语法-3"><a href="#一、语法-3" class="headerlink" title="一、语法"></a><strong>一、语法</strong></h3><p><strong>概念</strong>：类似于java的方法，将一组逻辑语句封装在方法体中，对外暴露方法名</p>
<p><strong>好处</strong>：1、隐藏了实现细节  2、提高代码的重用性</p>
<p><strong>调用</strong>：select 函数名(实参列表) 【from 表】;  //(实参列表)类型和个数保持一致</p>
<p><strong>特点</strong>：</p>
<p>  ①叫什么（函数名）</p>
<p>  ②干什么（函数功能）</p>
<p><strong>分类</strong>：</p>
<p>  1、<strong>单行函数</strong>（有返回值）</p>
<p>如 concat、length、ifnull等</p>
<p>  2、<strong>分组函数</strong></p>
<p>功能：做统计使用，又称为统计函数、聚合函数、组函数</p>
<p>常见函数：</p>
<h3 id="二、单行函数"><a href="#二、单行函数" class="headerlink" title="二、单行函数"></a><strong>二、单行函数</strong></h3><h4 id="1-字符函数："><a href="#1-字符函数：" class="headerlink" title="1. 字符函数："></a><strong>1. 字符函数：</strong></h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">length:	获取字节个数<span class="token punctuation">(</span>utf<span class="token operator">-</span><span class="token number">8</span>一个汉字代表<span class="token number">3</span>个字节<span class="token punctuation">,</span>gbk为<span class="token number">2</span>个字节<span class="token punctuation">)</span>
  concat
  substr
  instr
  trim
  upper
  lower
  lpad
  rpad
  <span class="token keyword">replace</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#1.length 获取参数值的字节个数</span>
<span class="token keyword">SELECT</span> LENGTH<span class="token punctuation">(</span><span class="token string">'john'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> LENGTH<span class="token punctuation">(</span><span class="token string">'张三丰hahaha'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%char%'</span>
 
<span class="token comment">#2.concat 拼接字符串</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span><span class="token string">'_'</span><span class="token punctuation">,</span>first_name<span class="token punctuation">)</span> 姓名 <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#3.upper、lower</span>
<span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span><span class="token string">'john'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> LOWER<span class="token punctuation">(</span><span class="token string">'joHn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#示例：将姓变大写，名变小写，然后拼接</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>UPPER<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">,</span>LOWER<span class="token punctuation">(</span>first_name<span class="token punctuation">)</span><span class="token punctuation">)</span>  姓名 <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#4.substr、substring</span>
注意：索引从<span class="token number">1</span>开始
<span class="token comment">#截取从指定索引处后面所有字符</span>
<span class="token keyword">SELECT</span> SUBSTR<span class="token punctuation">(</span><span class="token string">'李莫愁爱上了陆展元'</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>  out_put<span class="token punctuation">;</span> <span class="token comment">//陆展元  </span>
 
<span class="token comment">#截取从指定索引处指定字符长度的字符</span>
<span class="token keyword">SELECT</span> SUBSTR<span class="token punctuation">(</span><span class="token string">'李莫愁爱上了陆展元'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> out_put<span class="token punctuation">;</span> <span class="token comment">//李莫愁</span>
 
<span class="token comment">#案例：姓名中首字符大写，其他字符小写然后用_拼接，显示出来</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>UPPER<span class="token punctuation">(</span>SUBSTR<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'_'</span><span class="token punctuation">,</span>LOWER<span class="token punctuation">(</span>SUBSTR<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> out_put
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#5.instr 返回子串第一次出现的索引，如果找不到返回0</span>
<span class="token keyword">SELECT</span> INSTR<span class="token punctuation">(</span><span class="token string">'杨不殷六侠悔爱上了殷六侠'</span><span class="token punctuation">,</span><span class="token string">'殷八侠'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> out_put<span class="token punctuation">;</span>
 
<span class="token comment">#6.trim</span>
<span class="token keyword">SELECT</span> LENGTH<span class="token punctuation">(</span>TRIM<span class="token punctuation">(</span><span class="token string">'   张翠山   '</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> out_put<span class="token punctuation">;</span> <span class="token comment">//去除前后的无效字符</span>
<span class="token keyword">SELECT</span> TRIM<span class="token punctuation">(</span><span class="token string">'aa'</span> <span class="token keyword">FROM</span> <span class="token string">'aaaaaaaaa张aaaaaaaaaaaa翠山aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'</span><span class="token punctuation">)</span>  <span class="token keyword">AS</span> out_put<span class="token punctuation">;</span> <span class="token comment">//去除前后的字符</span>
 
<span class="token comment">#7.lpad 用指定的字符实现左填充指定长度</span>
<span class="token keyword">SELECT</span> LPAD<span class="token punctuation">(</span><span class="token string">'殷素素'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> out_put<span class="token punctuation">;</span>    <span class="token comment">//2-殷素-左填充右截断 10-*******殷素素</span>
 
<span class="token comment">#8.rpad 用指定的字符实现右填充指定长度</span>
<span class="token keyword">SELECT</span> RPAD<span class="token punctuation">(</span><span class="token string">'殷素素'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token string">'ab'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> out_put<span class="token punctuation">;</span>

<span class="token comment">#9.replace 替换</span>
<span class="token keyword">SELECT</span> <span class="token keyword">REPLACE</span><span class="token punctuation">(</span><span class="token string">'周芷若周芷若周芷若周芷若张无忌爱上了周芷若'</span><span class="token punctuation">,</span><span class="token string">'周芷若'</span><span class="token punctuation">,</span><span class="token string">'赵敏'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> out_put<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="2-数学函数："><a href="#2-数学函数：" class="headerlink" title="2. 数学函数："></a><strong>2. 数学函数：</strong></h4><pre class="line-numbers language-none"><code class="language-none">round
ceil
floor
truncate
Mod 
Rand() 取随机数，返回0-1之间的小数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#round 四舍五入</span>
<span class="token keyword">SELECT</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.55</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">1.567</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//小数点后面保留位数2</span>
 
<span class="token comment">#ceil 向上取整,返回&gt;=该参数的最小整数</span>
<span class="token keyword">SELECT</span> CEIL<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.02</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">#floor 向下取整，返回&lt;=该参数的最大整数</span>
<span class="token keyword">SELECT</span> FLOOR<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">9.99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#truncate 截断</span>
<span class="token keyword">SELECT</span> <span class="token keyword">TRUNCATE</span><span class="token punctuation">(</span><span class="token number">1.69999</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token number">1.6</span><span class="token operator">-</span>后面的都不要了

<span class="token comment">#mod取余</span>
<span class="token comment">/*
mod(a,b) ：  a-a/b*b
mod(-10,-3):-10- (-10)/(-3)*（-3）=-1
*/</span>
<span class="token keyword">SELECT</span> <span class="token function">MOD</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token number">10</span><span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="3-日期函数："><a href="#3-日期函数：" class="headerlink" title="3. 日期函数："></a><strong>3. 日期函数：</strong></h4><pre class="line-numbers language-none"><code class="language-none">now
curdate
curtime
year
month
monthname
day
hour
minute
second
str_to_date
date_format<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#now 返回当前系统日期+时间</span>
<span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">#curdate 返回当前系统日期，不包含时间</span>
<span class="token keyword">SELECT</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#curtime 返回当前时间，不包含日期</span>
<span class="token keyword">SELECT</span> CURTIME<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">#可以获取指定的部分，年、月、日、小时、分钟、秒</span>
<span class="token keyword">SELECT</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 年<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token string">'1998-1-1'</span><span class="token punctuation">)</span> 年<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span> 年 <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 月<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> MONTHNAME<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 月<span class="token punctuation">;</span> <span class="token comment">//出现月数的英文</span>
 
<span class="token comment">#str_to_date 将字符通过指定的格式转换成日期</span>
<span class="token keyword">SELECT</span> STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'1998-3-2'</span><span class="token punctuation">,</span><span class="token string">'%Y-%c-%d'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> out_put<span class="token punctuation">;</span>

<span class="token comment">#查询入职日期为1992--4-3的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> hiredate <span class="token operator">=</span> <span class="token string">'1992-4-3'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> hiredate <span class="token operator">=</span> STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'4-3 1992'</span><span class="token punctuation">,</span><span class="token string">'%c-%d %Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#date_format 将日期转换成字符</span>
<span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%y年%m月%d日'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> out_put<span class="token punctuation">;</span>
 
<span class="token comment">#查询有奖金的员工名和入职日期(xx月/xx日 xx年)</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>DATE_FORMAT<span class="token punctuation">(</span>hiredate<span class="token punctuation">,</span><span class="token string">'%m月/%d日 %y年'</span><span class="token punctuation">)</span> 入职日期
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0.png" alt="日期函数"></p>
<h4 id="4-其他函数："><a href="#4-其他函数：" class="headerlink" title="4. 其他函数："></a>4. 其他函数：</h4><pre class="line-numbers language-none"><code class="language-none">version
database
user
password(‘字符’)  	函数加密
md5(‘字符’)  		函数加密<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> VERSION<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 版本号
<span class="token keyword">SELECT</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 查看当前的数据库
<span class="token keyword">SELECT</span> <span class="token keyword">USER</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   当前的用户<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h4 id="5-流程控制函数"><a href="#5-流程控制函数" class="headerlink" title="5. 流程控制函数"></a><strong>5. 流程控制函数</strong></h4><pre class="line-numbers language-none"><code class="language-none">if
case<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#1.if函数： if else 的效果</span>
<span class="token keyword">SELECT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'大'</span><span class="token punctuation">,</span><span class="token string">'小'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>commission_pct<span class="token punctuation">,</span><span class="token keyword">IF</span><span class="token punctuation">(</span>commission_pct <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'没奖金，呵呵'</span><span class="token punctuation">,</span><span class="token string">'有奖金，嘻嘻'</span><span class="token punctuation">)</span> 备注
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#2.case函数的使用一： switch case 的效果</span>
<span class="token comment">/*
java中
switch(变量或表达式){
  case 常量1：语句1;break;
  ...
  default:语句n;break;
}

mysql中
case 要判断的字段（变量）或表达式
when 常量1 then 要显示的值1或 语句1;
when 常量2 then 要显示的值2或 语句2;
...
else 要显示的值n或语句n;
end
*/</span>

<span class="token comment">/*案例：查询员工的工资，要求
部门号=30，显示的工资为1.1倍
部门号=40，显示的工资为1.2倍
部门号=50，显示的工资为1.3倍
其他部门，显示的工资为原工资
*/</span>
<span class="token keyword">SELECT</span> salary 原始工资<span class="token punctuation">,</span>department_id<span class="token punctuation">,</span>
<span class="token keyword">CASE</span> department_id
<span class="token keyword">WHEN</span> <span class="token number">30</span> <span class="token keyword">THEN</span> salary<span class="token operator">*</span><span class="token number">1.1</span>
<span class="token keyword">WHEN</span> <span class="token number">40</span> <span class="token keyword">THEN</span> salary<span class="token operator">*</span><span class="token number">1.2</span>
<span class="token keyword">WHEN</span> <span class="token number">50</span> <span class="token keyword">THEN</span> salary<span class="token operator">*</span><span class="token number">1.3</span>
<span class="token keyword">ELSE</span> salary
<span class="token keyword">END</span> <span class="token keyword">AS</span> 新工资
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#3.case 函数的使用二：类似于 多重if</span>
<span class="token comment">/*
java中：
if(条件1){
  语句1；
}else if(条件2){
  语句2；
}
...
else{
  语句n;
}

mysql中：
case 
when 条件1 then 要显示的值1或 语句1;
when 条件2 then 要显示的值2或 语句2;
。。。
else 要显示的值n或语句n
end
*/</span>

<span class="token comment">#案例：查询员工的工资的情况</span>
<span class="token comment">#如果工资&gt;20000,显示A级别</span>
<span class="token comment">#如果工资&gt;15000,显示B级别</span>
<span class="token comment">#如果工资&gt;10000，显示C级别</span>
<span class="token comment">#否则，显示D级别</span>
<span class="token keyword">SELECT</span> salary<span class="token punctuation">,</span>
<span class="token keyword">CASE</span> 
<span class="token keyword">WHEN</span> salary<span class="token operator">&gt;</span><span class="token number">20000</span> <span class="token keyword">THEN</span> <span class="token string">'A'</span>
<span class="token keyword">WHEN</span> salary<span class="token operator">&gt;</span><span class="token number">15000</span> <span class="token keyword">THEN</span> <span class="token string">'B'</span>
<span class="token keyword">WHEN</span> salary<span class="token operator">&gt;</span><span class="token number">10000</span> <span class="token keyword">THEN</span> <span class="token string">'C'</span>
<span class="token keyword">ELSE</span> <span class="token string">'D'</span>
<span class="token keyword">END</span> <span class="token keyword">AS</span> 工资级别
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="三、分组函数"><a href="#三、分组函数" class="headerlink" title="三、分组函数"></a><strong>三、分组函数</strong></h3><p><strong>功能</strong>：用作统计使用，又称为聚合函数或统计函数或组函数</p>
<p><strong>分类</strong>：</p>
<p>sum 求和、avg 平均值、max 最大值 、min 最小值 、count 计算个数</p>
<p><strong>特点</strong>：</p>
<p>1、sum、avg一般用于处理数值型</p>
<p>max、min、count可以处理任何类型</p>
<p>2、以上分组函数都<strong>忽略null</strong>值</p>
<p>3、可以<strong>和distinct搭配</strong>实现去重的运算</p>
<p>4、count函数的单独介绍</p>
<p>一般使用count(*)用作统计行数</p>
<p>5、<strong>和分组函数一同查询的字段要求是group by后的字段</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#1、简单 的使用</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 和<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 平均<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 最高<span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 最低<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 个数
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 和<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> 平均<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 最高<span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 最低<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> 个数
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#2、参数支持哪些类型</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>		<span class="token comment">#任何类型</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>			<span class="token comment">#任何类型</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>				<span class="token comment">#任何类型</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>last_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>						<span class="token comment">#任何类型</span>

<span class="token comment">#3、是否忽略null(都忽略null)</span>
<span class="token keyword">SELECT</span> 
	<span class="token function">SUM</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">107</span> 
<span class="token keyword">FROM</span> 
	employees<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span> 
<span class="token keyword">SELECT</span> commission_pct <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#4、和distinct搭配</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#5、count函数的详细介绍</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>      <span class="token comment">//统计行数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>     <span class="token comment">//统计行数相当于在后面加一行全1的统计</span>
效率：
MYISAM存储引擎下  ，<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>的效率高
<span class="token keyword">INNODB</span>存储引擎下，<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>和<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>的效率差不多，比<span class="token function">COUNT</span><span class="token punctuation">(</span>字段<span class="token punctuation">)</span>要高一些

<span class="token comment">#6、和分组函数一同查询的字段有限制</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>employee_id  <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>     <span class="token comment">#显示一行的值   employee_id查出来的值没有意义</span>

    <span class="token comment">#1.查询各job_id的员工工资的最大值，最小值，平均值，总和，并按job_id升序</span>
    <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>job_id
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">;</span>

    <span class="token comment">#2.查询员工最高工资和最低工资的差距（DIFFERENCE）</span>
    <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> DIFFRENCE
    <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
    
    <span class="token comment">#3.查询各个管理者手下员工的最低工资，其中最低工资不能低于6000，没有管理者的员工不计算在内</span>
    <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>manager_id
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> manager_id <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> manager_id
    <span class="token keyword">HAVING</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">6000</span><span class="token punctuation">;</span>
    
	<span class="token comment">#3.查询自己活了多少天</span>
	<span class="token keyword">SELECT</span> DATEDIFF<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'1998-1-10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">#4.查询所有部门的编号，员工数量和工资平均值,并按平均工资降序</span>
    <span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> a
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> a <span class="token keyword">DESC</span><span class="token punctuation">;</span>
    
    <span class="token comment">#5.选择具有各个job_id的员工人数</span>
    <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 个数<span class="token punctuation">,</span>job_id
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="进阶5：分组查询"><a href="#进阶5：分组查询" class="headerlink" title="进阶5：分组查询"></a><strong>进阶5：分组查询</strong></h2><h3 id="一、语法："><a href="#一、语法：" class="headerlink" title="一、语法："></a>一、语法：</h3><p>select 查询列表············5</p>
<p>from 表 ···················1</p>
<p>【where 筛选条件】··········2</p>
<p>group by 分组的字段·········3</p>
<p>【having  分组后的筛选】;····4</p>
<p>【order by 排序的字段】;·····6</p>
<h3 id="二、特点："><a href="#二、特点：" class="headerlink" title="二、特点："></a>二、特点：</h3><p>1、和分组函数一同查询的字段必须是group by后出现的字段</p>
<p>2、筛选分为两类：分组前筛选和分组后筛选</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">针对的表</th>
<th align="center">位置</th>
<th align="center">连接的关键字</th>
</tr>
</thead>
<tbody><tr>
<td align="center">分组前筛选</td>
<td align="center">原始表</td>
<td align="center">group by前</td>
<td align="center">where</td>
</tr>
<tr>
<td align="center">分组后筛选</td>
<td align="center">group by后的结果集</td>
<td align="center">group by后</td>
<td align="center">having</td>
</tr>
</tbody></table>
<p>问题1：分组函数(sum、avg、max、min  、count )做筛选能不能放在where后面</p>
<p>答：不能</p>
<p>问题2：where——group by——having</p>
<p>一般来讲，能用分组前筛选的，尽量使用分组前筛选，提高效率</p>
<p>3、分组可以按单个字段也可以按多个字段</p>
<p>4、可以搭配着排序使用</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#引入：查询部门号为90的员工个数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> department_id<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>1.简单的分组</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：查询每个工种的员工平均工资</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>job_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">;</span>

<span class="token comment">#案例2：查询每个位置的部门个数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>location_id
<span class="token keyword">FROM</span> departments
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> location_id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>2、可以实现分组前的筛选</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：查询邮箱中包含a字符的 每个部门的最高工资</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> email <span class="token operator">LIKE</span> <span class="token string">'%a%'</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span>

<span class="token comment">#案例2：查询有奖金的每个领导手下员工的平均工资</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>manager_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> manager_id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong>3、分组后筛选</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询哪个部门的员工个数&gt;5</span>
<span class="token comment">#①查询每个部门的员工个数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span>

<span class="token comment">#② 筛选刚才①结果</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：每个工种有奖金的员工的最高工资&gt;12000的工种编号和最高工资</span>
<span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id
<span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">12000</span><span class="token punctuation">;</span>

<span class="token comment">#案例3：领导编号&gt;102的每个领导手下的最低工资大于5000的领导编号和最低工资</span>
manager_id<span class="token operator">&gt;</span><span class="token number">102</span>
<span class="token keyword">SELECT</span> manager_id<span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> manager_id
<span class="token keyword">HAVING</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">5000</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>4.添加排序</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：每个工种有奖金的员工的最高工资&gt;6000的工种编号和最高工资,按最高工资升序</span>
<span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> m
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id
<span class="token keyword">HAVING</span> m<span class="token operator">&gt;</span><span class="token number">6000</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> m <span class="token punctuation">;</span>

<span class="token comment">#5.按多个字段分组</span>
<span class="token comment">#案例：查询每个工种每个部门的最低工资,并按最低工资降序</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">,</span>job_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="进阶6-1：92语法-连接查询"><a href="#进阶6-1：92语法-连接查询" class="headerlink" title="进阶6.1：92语法 连接查询"></a><strong>进阶6.1：92语法 连接查询</strong></h2><h3 id="含义："><a href="#含义：" class="headerlink" title="含义："></a>含义：</h3><p>又称多表查询，当查询的字段来自于多个表时，就会用到连接查询</p>
<p>笛卡尔乘积现象：表1 有m行，表2有n行，结果=m*n行</p>
<p> <img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2023/cpp/image-20230414101555382.png" alt="image-20230414101555382"></p>
<p><strong>发生原因：</strong>没有有效的连接条件</p>
<p><strong>如何避免：</strong>添加有效的连接条件</p>
<p>分类：</p>
<p>  <strong>按年代分类：</strong></p>
<p>  sql92标准:仅仅支持内连接</p>
<p>  sql99标准【推荐】：支持内连接+外连接（左外和右外）+交叉连接</p>
<p>  <strong>按功能分类：</strong></p>
<p>​    内连接：</p>
<p>​      等值连接</p>
<p>​      非等值连接</p>
<p>​      自连接</p>
<p>​    外连接：</p>
<p>​      左外连接</p>
<p>​      右外连接</p>
<p>​      全外连接</p>
<p>​    交叉连接</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>boyName <span class="token keyword">FROM</span> boys<span class="token punctuation">,</span>beauty
<span class="token keyword">WHERE</span> beauty<span class="token punctuation">.</span>boyfriend_id<span class="token operator">=</span> boys<span class="token punctuation">.</span>id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="1、等值连接"><a href="#1、等值连接" class="headerlink" title="1、等值连接"></a>1、等值连接</h3><p>① 多表等值连接的结果为多表的交集部分</p>
<p>②n表连接，至少需要n-1个连接条件</p>
<p>③ 多表的顺序没有要求</p>
<p>④一般需要为表起别名</p>
<p>⑤可以搭配前面介绍的所有子句使用，比如排序、分组、筛选</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：查询女神名和对应的男神名</span>
<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>boyName 
<span class="token keyword">FROM</span> boys<span class="token punctuation">,</span>beauty
<span class="token keyword">WHERE</span> beauty<span class="token punctuation">.</span>boyfriend_id<span class="token operator">=</span> boys<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

<span class="token comment">#案例2：查询员工名和对应的部门名</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>departments<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2、为表起别名"><a href="#2、为表起别名" class="headerlink" title="2、为表起别名"></a>2、为表起别名</h4><p>①提高语句的简洁度</p>
<p>②区分多个重名的字段</p>
<p>注意：如果为表起了别名，则查询的字段就<strong>不能使用原来的表名去限定</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询员工名、工种号、工种名</span>
<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span>j<span class="token punctuation">.</span>job_title 		<span class="token comment">#SELECT employees.last_name,employees.job_id,jobs.job_title会报错</span>
<span class="token keyword">FROM</span> employees  e<span class="token punctuation">,</span>jobs j
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token operator">=</span>j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="3、两个表的顺序是否可以调换"><a href="#3、两个表的顺序是否可以调换" class="headerlink" title="3、两个表的顺序是否可以调换"></a>3、两个表的顺序是否可以调换</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询员工名、工种号、工种名</span>
<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span>j<span class="token punctuation">.</span>job_title
<span class="token keyword">FROM</span> jobs j<span class="token punctuation">,</span>employees e
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token operator">=</span>j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="4、可以加筛选"><a href="#4、可以加筛选" class="headerlink" title="4、可以加筛选"></a>4、可以加筛选</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询有奖金的员工名、部门名</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span> department_name <span class="token punctuation">,</span> commission_pct
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span> departments d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span>d<span class="token punctuation">.</span>department_id <span class="token operator">AND</span> e<span class="token punctuation">.</span>commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：查询城市名中第二个字符为o的部门名和城市名</span>
<span class="token keyword">SELECT</span> department_name<span class="token punctuation">,</span>city
<span class="token keyword">FROM</span> departments d<span class="token punctuation">,</span>locations l
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span>
<span class="token operator">AND</span> city <span class="token operator">LIKE</span> <span class="token string">'_o%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="5、可以加分组"><a href="#5、可以加分组" class="headerlink" title="5、可以加分组"></a>5、可以加分组</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：查询每个城市的部门个数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 个数<span class="token punctuation">,</span>city
<span class="token keyword">FROM</span> departments d<span class="token punctuation">,</span>locations l
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span><span class="token operator">=</span>l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> city<span class="token punctuation">;</span>

<span class="token comment">#案例2：查询有奖金的每个部门的部门名和部门的领导编号和该部门的最低工资</span>
<span class="token keyword">SELECT</span> department_name<span class="token punctuation">,</span>d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> departments d<span class="token punctuation">,</span>employees e
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token operator">AND</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_name<span class="token punctuation">,</span>d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="6、可以加排序"><a href="#6、可以加排序" class="headerlink" title="6、可以加排序"></a>6、可以加排序</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询每个工种的工种名和员工的个数，并且按员工个数降序</span>
<span class="token keyword">SELECT</span> job_title<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>jobs j
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token operator">=</span>j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_title
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="7、可以实现三表连接"><a href="#7、可以实现三表连接" class="headerlink" title="7、可以实现三表连接"></a>7、可以实现三表连接</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询员工名、部门名和所在的城市</span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>city
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d<span class="token punctuation">,</span>locations l
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">AND</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span><span class="token operator">=</span>l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">AND</span> city <span class="token operator">LIKE</span> <span class="token string">'s%'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> department_name <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2、非等值连接"><a href="#2、非等值连接" class="headerlink" title="2、非等值连接"></a>2、非等值连接</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：查询员工的工资和工资级别</span>
<span class="token keyword">SELECT</span> salary<span class="token punctuation">,</span>grade_level
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>job_grades g
<span class="token keyword">WHERE</span> salary <span class="token operator">BETWEEN</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>lowest_sal<span class="token punctuation">`</span></span> <span class="token operator">AND</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>highest_sal<span class="token punctuation">`</span></span>
<span class="token operator">AND</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>grade_level<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">'A'</span><span class="token punctuation">;</span>

<span class="token comment">/*
select salary,employee_id from employees;
select * from job_grades;
CREATE TABLE job_grades
(grade_level VARCHAR(3),
 lowest_sal  int,
 highest_sal int);

INSERT INTO job_grades
VALUES ('A', 1000, 2999);
INSERT INTO job_grades
VALUES ('B', 3000, 5999);
INSERT INTO job_grades
VALUES('C', 6000, 9999);
INSERT INTO job_grades
VALUES('D', 10000, 14999);
INSERT INTO job_grades
VALUES('E', 15000, 24999);
INSERT INTO job_grades
VALUES('F', 25000, 40000);
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3、自连接"><a href="#3、自连接" class="headerlink" title="3、自连接"></a>3、自连接</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询 员工名和上级的名称</span>
<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>m<span class="token punctuation">.</span>last_name
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>employees m
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token operator">=</span>m<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="进阶6-2：99语法-连接查询"><a href="#进阶6-2：99语法-连接查询" class="headerlink" title="进阶6.2：99语法 连接查询*"></a>进阶6.2：99语法 连接查询*</h2><h3 id="一、语法：-1"><a href="#一、语法：-1" class="headerlink" title="一、语法："></a>一、语法：</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 查询列表
<span class="token keyword">from</span> 表<span class="token number">1</span> 别名 【连接类型】
<span class="token keyword">join</span> 表<span class="token number">2</span> 别名 
<span class="token keyword">on</span> 连接条件
【<span class="token keyword">where</span> 筛选条件】
【<span class="token keyword">group</span> <span class="token keyword">by</span> 分组】
【<span class="token keyword">having</span> 筛选条件】
【<span class="token keyword">order</span> <span class="token keyword">by</span> 排序列表】<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="二、分类："><a href="#二、分类：" class="headerlink" title="二、分类："></a>二、分类：</h3><p>内连接（★）：inner</p>
<p>外连接</p>
<p>  左外(★):left 【outer】</p>
<p>  右外(★)：right 【outer】</p>
<p>  全外：full【outer】</p>
<p>交叉连接：cross </p>
<h4 id="一、内连接"><a href="#一、内连接" class="headerlink" title="一、内连接"></a>一、内连接</h4><p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E5%86%85%E8%BF%9E%E6%8E%A5.jpg" alt="内连接"></p>
<p><strong>语法：</strong></p>
<p>select 查询列表</p>
<p>from 表1 别名</p>
<p>inner join 表2 别名</p>
<p>on 连接条件;</p>
<p><strong>分类</strong>：</p>
<p>等值</p>
<p>非等值</p>
<p>自连接</p>
<p><strong>特点：</strong></p>
<p>①添加排序、分组、筛选</p>
<p>②inner可以省略</p>
<p>③ 筛选条件放在where后面，连接条件放在on后面，提高分离性，便于阅读</p>
<p>④inner join连接和sql92语法中的等值连接效果是一样的，都是查询多表的交集</p>
<h5 id="1、等值连接-1"><a href="#1、等值连接-1" class="headerlink" title="1、等值连接"></a>1、等值连接</h5><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1.查询员工名、部门名</span>
<span class="token keyword">USE</span> <span class="token identifier"><span class="token punctuation">`</span>myemployees<span class="token punctuation">`</span></span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> departments d
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span>  employees e
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">#案例2.查询名字中包含e的员工名和工种名（添加筛选）</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_title
<span class="token keyword">FROM</span> employees e
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> jobs j
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token operator">=</span>  j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>last_name<span class="token punctuation">`</span></span> <span class="token operator">LIKE</span> <span class="token string">'%e%'</span><span class="token punctuation">;</span>

<span class="token comment">#3. 查询部门个数&gt;3的城市名和部门个数，（添加分组+筛选）</span>
<span class="token comment">#①查询每个城市的部门个数</span>
<span class="token comment">#②在①结果上筛选满足条件的</span>
<span class="token keyword">SELECT</span> city<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 部门个数
<span class="token keyword">FROM</span> departments d
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> locations l
<span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span><span class="token operator">=</span>l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> city
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">#案例4.查询哪个部门的员工个数&gt;3的部门名和员工个数，并按个数降序（添加排序）</span>
<span class="token comment">#①查询每个部门的员工个数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments d <span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_name

<span class="token comment">#② 在①结果上筛选员工个数&gt;3的记录，并排序</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 个数<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_name
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">3</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">#5.查询员工名、部门名、工种名，并按部门名降序（添加三表连接）</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>job_title
<span class="token keyword">FROM</span> employees e
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments d <span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> jobs j <span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> department_name <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2、非等值连接-1"><a href="#2、非等值连接-1" class="headerlink" title="2、非等值连接"></a>2、非等值连接</h5><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#查询员工的工资级别</span>
<span class="token keyword">SELECT</span> salary<span class="token punctuation">,</span>grade_level
<span class="token keyword">FROM</span> employees e
<span class="token keyword">JOIN</span> job_grades g
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token operator">BETWEEN</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>lowest_sal<span class="token punctuation">`</span></span> <span class="token operator">AND</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>highest_sal<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
 
<span class="token comment">#查询工资级别的个数&gt;20的个数，并且按工资级别降序</span>
 <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>grade_level
<span class="token keyword">FROM</span> employees e
 <span class="token keyword">JOIN</span> job_grades g
 <span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token operator">BETWEEN</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>lowest_sal<span class="token punctuation">`</span></span> <span class="token operator">AND</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>highest_sal<span class="token punctuation">`</span></span>
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> grade_level
 <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">20</span>
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> grade_level <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="3、自连接-1"><a href="#3、自连接-1" class="headerlink" title="3、自连接"></a>3、自连接</h5><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"> <span class="token comment">#查询员工的名字、上级的名字</span>
 <span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>last_name
 <span class="token keyword">FROM</span> employees e
 <span class="token keyword">JOIN</span> employees m
 <span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
 
  <span class="token comment">#查询姓名中包含字符k的员工的名字、上级的名字</span>
 <span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>last_name
 <span class="token keyword">FROM</span> employees e
 <span class="token keyword">JOIN</span> employees m
 <span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span>
 <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>last_name<span class="token punctuation">`</span></span> <span class="token operator">LIKE</span> <span class="token string">'%k%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="二、外连接"><a href="#二、外连接" class="headerlink" title="二、外连接*"></a>二、外连接*</h4><p> <strong>应用场景：</strong>用于查询一个表中有，另一个表没有的记录</p>
<p> <img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2023/cpp/image-20230414105100761.png" alt="image-20230414105100761"></p>
<p> <strong>特点：</strong></p>
<p> 1、外连接的查询结果为主表中的所有记录</p>
<p>  如果从表中有和它匹配的，则显示匹配的值</p>
<p>  如果从表中没有和它匹配的，则显示null</p>
<p>  外连接查询结果=内连接结果+主表中有而从表没有的记录</p>
<p> 2、左外连接，left join左边的是主表：以左边的表为主去匹配，匹配不上的用null填充，反正出现主表的行数为准</p>
<p>  右外连接，right join右边的是主表 以右边的表为主</p>
<p> 3、左外和右外交换两个表的顺序，可以实现同样的效果 </p>
<p> 4、全外连接=内连接的结果+表1中有但表2没有的+表2中有但表1没有的</p>
<h5 id="1-左外连接"><a href="#1-左外连接" class="headerlink" title="1.左外连接"></a>1.左外连接</h5><p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5.png" alt="左外连接"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">  <span class="token comment">#引入：查询男朋友 不在男神表的的女神名(筛选选择主键（非空）)</span>
 <span class="token keyword">SELECT</span> b<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>bo<span class="token punctuation">.</span><span class="token operator">*</span>
 <span class="token keyword">FROM</span> boys bo
 <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> beauty b
 <span class="token keyword">ON</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyfriend_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span>
 <span class="token keyword">WHERE</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
 
 <span class="token comment">#案例1：查询哪个部门没有员工</span>
 <span class="token comment">#左外</span>
 <span class="token keyword">SELECT</span> d<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>employee_id
 <span class="token keyword">FROM</span> departments d
 <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> employees e
 <span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
 <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2-右外连接"><a href="#2-右外连接" class="headerlink" title="2.右外连接"></a>2.右外连接</h5><p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5.png" alt="右外连接"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> d<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>employee_id
 <span class="token keyword">FROM</span> employees e
 <span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d
 <span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
 <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="3-全外"><a href="#3-全外" class="headerlink" title="3. 全外"></a>3. 全外</h5><p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E5%85%A8%E5%A4%96%E8%BF%9E%E6%8E%A5.png" alt="全外连接"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">USE</span> girls<span class="token punctuation">;</span>
 <span class="token keyword">SELECT</span> b<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>bo<span class="token punctuation">.</span><span class="token operator">*</span>
 <span class="token keyword">FROM</span> beauty b
 <span class="token keyword">FULL</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> boys bo
 <span class="token keyword">ON</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyfriend_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> bo<span class="token punctuation">.</span>id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="4-交叉连接"><a href="#4-交叉连接" class="headerlink" title="4. 交叉连接"></a>4. 交叉连接</h5><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"> <span class="token keyword">SELECT</span> b<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>bo<span class="token punctuation">.</span><span class="token operator">*</span>
 <span class="token keyword">FROM</span> beauty b
 <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> boys bo<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h2 id="进阶7：子查询"><a href="#进阶7：子查询" class="headerlink" title="进阶7：子查询"></a>进阶7：子查询</h2><h3 id="含义：-1"><a href="#含义：-1" class="headerlink" title="含义："></a>含义：</h3><p>出现在其他语句中的select语句，称为子查询或内查询</p>
<p>外部的查询语句，称为主查询或外查询</p>
<h3 id="分类："><a href="#分类：" class="headerlink" title="分类："></a>分类：</h3><p>按子查询出现的位置：</p>
<p>  <strong>select后面</strong>：</p>
<p>​    仅仅支持标量子查询</p>
<p>  <strong>from后面</strong>：</p>
<p>​    支持表子查询</p>
<p>  <strong>where或having后面</strong>：★</p>
<p>​    <strong>标量子查询（单行） √  （一行一列）</strong></p>
<p>​    <strong>列子查询  （多行） √</strong></p>
<p>​    行子查询</p>
<p>  exists后面（相关子查询）</p>
<p>​    表子查询</p>
<p>按结果集的行列数不同：</p>
<p>  标量子查询（结果集只有一行一列）</p>
<p>  列子查询（结果集只有一列多行）</p>
<p>  行子查询（结果集有一行多列）</p>
<p>  表子查询（结果集一般为多行多列）</p>
<h4 id="一、where或having后面"><a href="#一、where或having后面" class="headerlink" title="一、where或having后面"></a>一、where或having后面</h4><p><strong>1、标量子查询（单行子查询）</strong></p>
<p><strong>2、列子查询（一列多行）</strong></p>
<p><strong>3、行子查询（一行多列）</strong></p>
<p><strong>特点：</strong></p>
<p>①子查询放在小括号内</p>
<p>②子查询一般放在条件的右侧</p>
<p>③标量子查询，一般搭配着单行操作符使用</p>
<p>&gt;     &lt;     &gt;=     &lt;=     =     &lt;&gt;</p>
<p>列子查询，一般搭配着多行操作符使用</p>
<p>in、any/some、all</p>
<p>④子查询的执行优先于主查询执行，主查询的条件用到了子查询的结果</p>
<h5 id="1-标量子查询★"><a href="#1-标量子查询★" class="headerlink" title="1.标量子查询★"></a>1.标量子查询★</h5><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：谁的工资比 Abel 高?</span>
<span class="token comment">#①查询Abel的工资</span>
<span class="token keyword">SELECT</span> salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span>

<span class="token comment">#②查询员工的信息，满足 salary&gt;①结果</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> salary<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> salary
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：返回job_id与141号员工相同，salary比143号员工多的员工 姓名，job_id 和工资</span>
<span class="token comment">#①查询141号员工的job_id</span>
<span class="token keyword">SELECT</span> job_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">141</span>

<span class="token comment">#②查询143号员工的salary</span>
<span class="token keyword">SELECT</span> salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">143</span>

<span class="token comment">#③查询员工的姓名，job_id 和工资，要求job_id=①并且salary&gt;②</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> job_id
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">141</span>
<span class="token punctuation">)</span> <span class="token operator">AND</span> salary<span class="token operator">&gt;</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> salary
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">143</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#案例3：返回公司工资最少的员工的last_name,job_id和salary</span>
<span class="token comment">#①查询公司的 最低工资</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees

<span class="token comment">#②查询last_name,job_id和salary，要求salary=①</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> salary<span class="token operator">=</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> employees
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#案例4：查询最低工资大于50号部门最低工资的部门id和其最低工资</span>
<span class="token comment">#①查询50号部门的最低工资</span>
<span class="token keyword">SELECT</span>  <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">50</span>

<span class="token comment">#②查询每个部门的最低工资</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id

<span class="token comment">#③ 在②基础上筛选，满足min(salary)&gt;①</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token keyword">HAVING</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">50</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#非法使用标量子查询</span>

<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token keyword">HAVING</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  salary
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">250</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2-列子查询（多行子查询）★"><a href="#2-列子查询（多行子查询）★" class="headerlink" title="2.列子查询（多行子查询）★"></a>2.列子查询（多行子查询）★</h5><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：返回location_id是1400或1700的部门中的所有员工姓名</span>

<span class="token comment">#①查询location_id是1400或1700的部门编号</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> department_id
<span class="token keyword">FROM</span> departments
<span class="token keyword">WHERE</span> location_id <span class="token operator">IN</span><span class="token punctuation">(</span><span class="token number">1400</span><span class="token punctuation">,</span><span class="token number">1700</span><span class="token punctuation">)</span>

<span class="token comment">#②查询员工姓名，要求部门号是①列表中的某一个</span>

<span class="token keyword">SELECT</span> last_name
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> department_id  <span class="token operator">&lt;&gt;</span><span class="token keyword">ALL</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> department_id
    <span class="token keyword">FROM</span> departments
    <span class="token keyword">WHERE</span> location_id <span class="token operator">IN</span><span class="token punctuation">(</span><span class="token number">1400</span><span class="token punctuation">,</span><span class="token number">1700</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：返回其它工种中比job_id为‘IT_PROG’工种任一工资低的员工的员工号、姓名、job_id 以及salary</span>

<span class="token comment">#①查询job_id为‘IT_PROG’部门任一工资</span>

<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token string">'IT_PROG'</span>

<span class="token comment">#②查询员工号、姓名、job_id 以及salary，salary&lt;(①)的任意一个</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>employee_id<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> salary<span class="token operator">&lt;</span><span class="token keyword">ANY</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> salary
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token string">'IT_PROG'</span>

<span class="token punctuation">)</span> <span class="token operator">AND</span> job_id<span class="token operator">&lt;&gt;</span><span class="token string">'IT_PROG'</span><span class="token punctuation">;</span>

<span class="token comment">#或</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>employee_id<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> salary<span class="token operator">&lt;</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token string">'IT_PROG'</span>

<span class="token punctuation">)</span> <span class="token operator">AND</span> job_id<span class="token operator">&lt;&gt;</span><span class="token string">'IT_PROG'</span><span class="token punctuation">;</span>

<span class="token comment">#案例3：返回其它部门中比job_id为‘IT_PROG’部门所有工资都低的员工   的员工号、姓名、job_id 以及salary</span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>employee_id<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> salary<span class="token operator">&lt;</span><span class="token keyword">ALL</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> salary
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token string">'IT_PROG'</span>

<span class="token punctuation">)</span> <span class="token operator">AND</span> job_id<span class="token operator">&lt;&gt;</span><span class="token string">'IT_PROG'</span><span class="token punctuation">;</span>

<span class="token comment">#或</span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>employee_id<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> salary<span class="token operator">&lt;</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span> salary<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token string">'IT_PROG'</span>

<span class="token punctuation">)</span> <span class="token operator">AND</span> job_id<span class="token operator">&lt;&gt;</span><span class="token string">'IT_PROG'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="3、行子查询（结果集一行多列或多行多列）"><a href="#3、行子查询（结果集一行多列或多行多列）" class="headerlink" title="3、行子查询（结果集一行多列或多行多列）"></a>3、行子查询（结果集一行多列或多行多列）</h5><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询员工编号最小并且工资最高的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>employee_id<span class="token punctuation">,</span>salary<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> employees
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#①查询最小的员工编号</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees

<span class="token comment">#②查询最高工资</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> employees

<span class="token comment">#③查询员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> employee_id<span class="token operator">=</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> employees

<span class="token punctuation">)</span><span class="token operator">AND</span> salary<span class="token operator">=</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> employees

<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="二、select后面-仅仅支持标量子查询"><a href="#二、select后面-仅仅支持标量子查询" class="headerlink" title="二、select后面(仅仅支持标量子查询)"></a>二、select后面(仅仅支持标量子查询)</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询每个部门的员工个数</span>

<span class="token keyword">SELECT</span> d<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token punctuation">(</span>

    <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> employees e
    <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
 <span class="token punctuation">)</span> 个数
 <span class="token keyword">FROM</span> departments d<span class="token punctuation">;</span>
 
 
 <span class="token comment">#案例2：查询员工号=102的部门名</span>
 
<span class="token keyword">SELECT</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> department_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id
    <span class="token keyword">FROM</span> departments d
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> employees e
    <span class="token keyword">ON</span> d<span class="token punctuation">.</span>department_id<span class="token operator">=</span>e<span class="token punctuation">.</span>department_id
    <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>employee_id<span class="token operator">=</span><span class="token number">102</span>
    
<span class="token punctuation">)</span> 部门名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="三、from后面"><a href="#三、from后面" class="headerlink" title="三、from后面"></a>三、from后面</h4><p><strong>将子查询结果充当一张表，要求必须起别名</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询每个部门的平均工资的工资等级</span>
<span class="token comment">#①查询每个部门的平均工资</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> job_grades<span class="token punctuation">;</span>

<span class="token comment">#②连接①的结果集和job_grades表，筛选条件平均工资 between lowest_sal and highest_sal</span>

<span class="token keyword">SELECT</span>  ag_dep<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>grade_level<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> ag<span class="token punctuation">,</span>department_id
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token punctuation">)</span> ag_dep
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> job_grades g
<span class="token keyword">ON</span> ag_dep<span class="token punctuation">.</span>ag <span class="token operator">BETWEEN</span> lowest_sal <span class="token operator">AND</span> highest_sal<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="四、exists后面（相关子查询）"><a href="#四、exists后面（相关子查询）" class="headerlink" title="四、exists后面（相关子查询）"></a>四、exists后面（相关子查询）</h4><p><strong>语法：</strong></p>
<p>exists(完整的查询语句)</p>
<p>结果：1或0</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> employee_id <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> salary<span class="token operator">=</span><span class="token number">300000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#案例1：查询有员工的部门名</span>

<span class="token comment">#in</span>
<span class="token keyword">SELECT</span> department_name
<span class="token keyword">FROM</span> departments d
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IN</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> department_id
    <span class="token keyword">FROM</span> employees
<span class="token punctuation">)</span>

<span class="token comment">#exists</span>

<span class="token keyword">SELECT</span> department_name
<span class="token keyword">FROM</span> departments d
<span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span>
    <span class="token keyword">FROM</span> employees e
    <span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：查询没有女朋友的男神信息</span>

<span class="token comment">#in</span>

<span class="token keyword">SELECT</span> bo<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> boys bo
<span class="token keyword">WHERE</span> bo<span class="token punctuation">.</span>id <span class="token operator">NOT</span> <span class="token operator">IN</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> boyfriend_id
    <span class="token keyword">FROM</span> beauty
<span class="token punctuation">)</span>

<span class="token comment">#exists</span>
<span class="token keyword">SELECT</span> bo<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> boys bo
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> boyfriend_id
    <span class="token keyword">FROM</span> beauty b
    <span class="token keyword">WHERE</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyfriend_id<span class="token punctuation">`</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="进阶8：分页查询-★"><a href="#进阶8：分页查询-★" class="headerlink" title="进阶8：分页查询 ★"></a><strong>进阶8：分页查询 ★</strong></h2><h3 id="应用场景："><a href="#应用场景：" class="headerlink" title="应用场景："></a>应用场景：</h3><p>当要显示的数据，一页显示不全，需要分页提交sql请求</p>
<h3 id="语法："><a href="#语法：" class="headerlink" title="语法："></a>语法：</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">  <span class="token keyword">select</span> 查询列表
    <span class="token keyword">from</span> 表
    【<span class="token keyword">join</span> <span class="token keyword">type</span> <span class="token keyword">join</span> 表<span class="token number">2</span>
    <span class="token keyword">on</span> 连接条件
    <span class="token keyword">where</span> 筛选条件
    <span class="token keyword">group</span> <span class="token keyword">by</span> 分组字段
    <span class="token keyword">having</span> 分组后的筛选
    <span class="token keyword">order</span> <span class="token keyword">by</span> 排序的字段】
    <span class="token keyword">limit</span> 【<span class="token keyword">offset</span><span class="token punctuation">,</span>】size<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>  offset要显示条目的起始索引（起始索引从0开始）</p>
<p>  size 要显示的条目个数</p>
<h3 id="特点："><a href="#特点：" class="headerlink" title="特点："></a>特点：</h3><p>  ①limit语句放在查询语句的最后</p>
<p>  ②公式</p>
<p>  要显示的页数 page，每页的条目数size</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> 查询列表
<span class="token keyword">from</span> 表
<span class="token keyword">limit</span> <span class="token punctuation">(</span>page<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>size<span class="token punctuation">,</span>size<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>  size=10</p>
<p>  page  </p>
<p>  1  0</p>
<p>  2  10</p>
<p>  3  20</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：查询前五条员工信息</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span>  employees <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span>  employees <span class="token keyword">LIMIT</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：查询第11条——第25条</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span>  employees <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">;</span>

<span class="token comment">#案例3：有奖金的员工信息，并且工资较高的前10名显示出来</span>
<span class="token keyword">SELECT</span> 
    <span class="token operator">*</span> 
<span class="token keyword">FROM</span>
    employees 
<span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span> 
<span class="token keyword">LIMIT</span> <span class="token number">10</span> <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="进阶9：联合查询"><a href="#进阶9：联合查询" class="headerlink" title="进阶9：联合查询"></a><strong>进阶9：联合查询</strong></h2><p><strong>union 联合 合并</strong>：将多条查询语句的结果合并成一个结果</p>
<h3 id="语法：-1"><a href="#语法：-1" class="headerlink" title="语法："></a>语法：</h3><p>查询语句1</p>
<p>union</p>
<p>查询语句2</p>
<p>union</p>
<p>…</p>
<h3 id="应用场景：-1"><a href="#应用场景：-1" class="headerlink" title="应用场景："></a>应用场景：</h3><p>要查询的结果来自于多个表，且多个表没有直接的连接关系，但查询的信息一致时</p>
<h3 id="特点：★"><a href="#特点：★" class="headerlink" title="特点：★"></a>特点：★</h3><p>1、要求多条查询语句的查询列数是一致的！</p>
<p>2、要求多条查询语句的查询的每一列的类型和顺序最好一致（默认表头是第一个查询的字段名）</p>
<p>3、union关键字默认去重，如果使用union all 可以包含重复项</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#引入的案例：查询部门编号&gt;90或邮箱包含a的员工信息</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> email <span class="token operator">LIKE</span> <span class="token string">'%a%'</span> <span class="token operator">OR</span> department_id<span class="token operator">&gt;</span><span class="token number">90</span><span class="token punctuation">;</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees  <span class="token keyword">WHERE</span> email <span class="token operator">LIKE</span> <span class="token string">'%a%'</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees  <span class="token keyword">WHERE</span> department_id<span class="token operator">&gt;</span><span class="token number">90</span><span class="token punctuation">;</span>

<span class="token comment">#案例：查询中国用户中男性的信息以及外国用户中年男性的用户信息</span>

<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>cname <span class="token keyword">FROM</span> t_ca <span class="token keyword">WHERE</span> csex<span class="token operator">=</span><span class="token string">'男'</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> t_id<span class="token punctuation">,</span>tname <span class="token keyword">FROM</span> t_ua <span class="token keyword">WHERE</span> tGender<span class="token operator">=</span><span class="token string">'male'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="第三章-DML数据操作语言"><a href="#第三章-DML数据操作语言" class="headerlink" title="第三章 DML数据操作语言"></a>第三章 DML数据操作语言</h1><p><strong>插入：insert</strong></p>
<p><strong>修改：update</strong></p>
<p><strong>删除：delete</strong></p>
<h2 id="一、插入语句"><a href="#一、插入语句" class="headerlink" title="一、插入语句"></a>一、插入语句</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#方式一：经典的插入</span>
<span class="token comment">/*
语法：
insert into 表名(列名,...) values(值1,...);
*/</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> beauty<span class="token punctuation">;</span>
<span class="token comment">#1.插入的值的类型要与列的类型一致或兼容</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>sex<span class="token punctuation">,</span>borndate<span class="token punctuation">,</span>phone<span class="token punctuation">,</span>photo<span class="token punctuation">,</span>boyfriend_id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token string">'唐艺昕'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1990-4-23'</span><span class="token punctuation">,</span><span class="token string">'1898888888'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#2.不可以为null的列必须插入值。可以为null的列如何插入值？</span>
<span class="token comment">#方式一：</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>sex<span class="token punctuation">,</span>borndate<span class="token punctuation">,</span>phone<span class="token punctuation">,</span>photo<span class="token punctuation">,</span>boyfriend_id<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token string">'唐艺昕'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1990-4-23'</span><span class="token punctuation">,</span><span class="token string">'1898888888'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#方式二：</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>sex<span class="token punctuation">,</span>phone<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token string">'娜扎'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1388888888'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#3.列的顺序是否可以调换</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>sex<span class="token punctuation">,</span>id<span class="token punctuation">,</span>phone<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'蒋欣'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token string">'110'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#4.列数和值的个数必须一致</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>sex<span class="token punctuation">,</span>id<span class="token punctuation">,</span>phone<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'关晓彤'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token string">'110'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#5.可以省略列名，默认所有列，而且列的顺序和表中列的顺序一致</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token string">'张飞'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'119'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#方式二：</span>
<span class="token comment">/*
语法：
insert into 表名
set 列名=值,列名=值,...
*/</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty
<span class="token keyword">SET</span> id<span class="token operator">=</span><span class="token number">19</span><span class="token punctuation">,</span>NAME<span class="token operator">=</span><span class="token string">'刘涛'</span><span class="token punctuation">,</span>phone<span class="token operator">=</span><span class="token string">'999'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#两种方式大pk ★</span>
<span class="token comment">#1、方式一支持插入多行,方式二不支持</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token string">'唐艺昕1'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1990-4-23'</span><span class="token punctuation">,</span><span class="token string">'1898888888'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'唐艺昕2'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1990-4-23'</span><span class="token punctuation">,</span><span class="token string">'1898888888'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token string">'唐艺昕3'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1990-4-23'</span><span class="token punctuation">,</span><span class="token string">'1898888888'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#2、方式一支持子查询，方式二不支持（子查询的结果作为输入）</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>phone<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token number">26</span><span class="token punctuation">,</span><span class="token string">'宋茜'</span><span class="token punctuation">,</span><span class="token string">'11809866'</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> beauty<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>phone<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>boyname<span class="token punctuation">,</span><span class="token string">'1234567'</span>
<span class="token keyword">FROM</span> boys <span class="token keyword">WHERE</span> id<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="二、修改语句"><a href="#二、修改语句" class="headerlink" title="二、修改语句"></a><strong>二、修改语句</strong></h2><h3 id="1-修改单表的记录★"><a href="#1-修改单表的记录★" class="headerlink" title="1.修改单表的记录★"></a>1.修改单表的记录★</h3><p><strong>语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> 表名
<span class="token keyword">set</span> 列<span class="token operator">=</span>新值<span class="token punctuation">,</span>列<span class="token operator">=</span>新值<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">where</span> 筛选条件<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="2-修改多表的记录【补充】"><a href="#2-修改多表的记录【补充】" class="headerlink" title="2.修改多表的记录【补充】"></a>2.修改多表的记录【补充】</h3><p><strong>语法：</strong></p>
<p><strong>sql92语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> 表<span class="token number">1</span> 别名<span class="token punctuation">,</span>表<span class="token number">2</span> 别名
<span class="token keyword">set</span> 列<span class="token operator">=</span>值<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">where</span> 连接条件
<span class="token operator">and</span> 筛选条件<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>sql99语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">update</span> 表<span class="token number">1</span> 别名
<span class="token keyword">inner</span><span class="token operator">|</span><span class="token keyword">left</span><span class="token operator">|</span><span class="token keyword">right</span> <span class="token keyword">join</span> 表<span class="token number">2</span> 别名
<span class="token keyword">on</span> 连接条件
<span class="token keyword">set</span> 列<span class="token operator">=</span>值<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">where</span> 筛选条件<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1.</span>修改单表的记录
<span class="token comment">#案例1：修改beauty表中姓唐的女神的电话为13899888899</span>
<span class="token keyword">UPDATE</span> beauty <span class="token keyword">SET</span> phone <span class="token operator">=</span> <span class="token string">'13899888899'</span>
<span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'唐%'</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：修改boys表中id为2的名称为张飞，魅力值 10</span>
<span class="token keyword">UPDATE</span> boys <span class="token keyword">SET</span> boyname<span class="token operator">=</span><span class="token string">'张飞'</span><span class="token punctuation">,</span>usercp<span class="token operator">=</span><span class="token number">10</span>
<span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">#2.修改多表的记录</span>
<span class="token comment">#案例 1：修改张无忌的女朋友的手机号为114</span>
<span class="token keyword">UPDATE</span> boys bo <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> beauty b <span class="token keyword">ON</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyfriend_id<span class="token punctuation">`</span></span>
<span class="token keyword">SET</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>phone<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">'119'</span><span class="token punctuation">,</span>bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>userCP<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token number">1000</span>
<span class="token keyword">WHERE</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyName<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">'张无忌'</span><span class="token punctuation">;</span>

<span class="token comment">#案例2：修改没有男朋友的女神的男朋友编号都为2号</span>
<span class="token keyword">UPDATE</span> boys bo <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> beauty b <span class="token keyword">ON</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyfriend_id<span class="token punctuation">`</span></span>
<span class="token keyword">SET</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyfriend_id<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token number">2</span>
<span class="token keyword">WHERE</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="三、删除语句"><a href="#三、删除语句" class="headerlink" title="三、删除语句"></a>三、删除语句</h2><p><strong>方式一：delete</strong></p>
<h3 id="1、单表的删除【★】"><a href="#1、单表的删除【★】" class="headerlink" title="1、单表的删除【★】"></a><strong>1、单表的删除【★】</strong></h3><p><strong>delete from 表名 【where 筛选条】件【limit 值】</strong></p>
<h3 id="2、多表的删除【补充】"><a href="#2、多表的删除【补充】" class="headerlink" title="2、多表的删除【补充】"></a>2、多表的删除【补充】</h3><p><strong>sql92语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">delete</span> 表<span class="token number">1</span>的别名<span class="token punctuation">,</span>表<span class="token number">2</span>的别名
<span class="token keyword">from</span> 表<span class="token number">1</span> 别名<span class="token punctuation">,</span>表<span class="token number">2</span> 别名
<span class="token keyword">where</span> 连接条件
<span class="token operator">and</span> 筛选条件<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>sql99语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">delete</span> 表<span class="token number">1</span>的别名<span class="token punctuation">,</span>表<span class="token number">2</span>的别名
<span class="token keyword">from</span> 表<span class="token number">1</span> 别名
<span class="token keyword">inner</span><span class="token operator">|</span><span class="token keyword">left</span><span class="token operator">|</span><span class="token keyword">right</span> <span class="token keyword">join</span> 表<span class="token number">2</span> 别名 <span class="token keyword">on</span> 连接条件
<span class="token keyword">where</span> 筛选条件<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>方式二：truncate</strong></p>
<p>语法：truncate table 表名;</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#方式一：delete</span>
<span class="token comment">#1.单表的删除</span>
<span class="token comment">#案例：删除手机号以9结尾的女神信息</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> beauty <span class="token keyword">WHERE</span> phone <span class="token operator">LIKE</span> <span class="token string">'%9'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> beauty<span class="token punctuation">;</span>

<span class="token comment">#2.多表的删除</span>
<span class="token comment">#案例：删除张无忌的女朋友的信息</span>
<span class="token keyword">DELETE</span> b
<span class="token keyword">FROM</span> beauty b
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> boys bo <span class="token keyword">ON</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyfriend_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyName<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">'张无忌'</span><span class="token punctuation">;</span>

<span class="token comment">#案例：删除黄晓明的信息以及他女朋友的信息</span>
<span class="token keyword">DELETE</span> b<span class="token punctuation">,</span>bo
<span class="token keyword">FROM</span> beauty b
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> boys bo <span class="token keyword">ON</span> b<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyfriend_id<span class="token punctuation">`</span></span><span class="token operator">=</span>bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> bo<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>boyName<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token string">'黄晓明'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#方式二：truncate语句</span>
<span class="token comment">#案例：将魅力值&gt;100的男神信息删除</span>
<span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> boys <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="3-delete-pk-truncate【面试题★】"><a href="#3-delete-pk-truncate【面试题★】" class="headerlink" title="3. delete pk truncate【面试题★】"></a><strong>3. delete pk truncate【面试题★】</strong></h3><p>1.delete 可以加where 条件，truncate不能加</p>
<p>2.truncate删除，效率高一丢丢</p>
<p>3.假如要删除的表中有自增长列，</p>
<p>如果用delete删除后，再插入数据，自增长列的值从断点开始，</p>
<p>而truncate删除后，再插入数据，自增长列的值从1开始。</p>
<p>4.truncate删除没有返回值，delete删除有返回值</p>
<p>5.truncate删除不能回滚，delete删除可以回滚.</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> boys<span class="token punctuation">;</span>

<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> boys<span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> boys<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> boys <span class="token punctuation">(</span>boyname<span class="token punctuation">,</span>usercp<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'张飞'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'刘备'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'关云长'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="第四章-DDL数据定义语言-库和表的管理"><a href="#第四章-DDL数据定义语言-库和表的管理" class="headerlink" title="第四章 DDL数据定义语言(库和表的管理)"></a>第四章 DDL数据定义语言(库和表的管理)</h2><h2 id="一、库的管理"><a href="#一、库的管理" class="headerlink" title="一、库的管理"></a>一、库的管理</h2><h3 id="1、库的创建"><a href="#1、库的创建" class="headerlink" title="1、库的创建"></a>1、库的创建</h3><p><strong>语法：</strong></p>
<pre class="line-numbers language-none"><code class="language-none">create database  [if not exists]库名【character set字符集】;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：创建库Books</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> books <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="2、库的修改"><a href="#2、库的修改" class="headerlink" title="2、库的修改"></a>2、库的修改</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">RENAME</span> <span class="token keyword">DATABASE</span> books <span class="token keyword">TO</span> 新库名<span class="token punctuation">;</span>
<span class="token comment">#更改库的字符集</span>
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> books <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> gbk<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="3、库的删除"><a href="#3、库的删除" class="headerlink" title="3、库的删除"></a>3、库的删除</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> books<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="二、表的管理★"><a href="#二、表的管理★" class="headerlink" title="二、表的管理★"></a><strong>二、表的管理</strong>★</h2><h3 id="1-表的创建-★"><a href="#1-表的创建-★" class="headerlink" title="1.表的创建 ★"></a>1.表的创建 ★</h3><p><strong>语法：</strong></p>
<p>create table 表名(</p>
<p>  列名 列的类型【(长度) 约束】,</p>
<p>  列名 列的类型【(长度) 约束】,</p>
<p>  列名 列的类型【(长度) 约束】,</p>
<p>  …</p>
<p>  列名 列的类型【(长度) 约束】</p>
<p>)</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：创建表Book</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> book<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">,</span><span class="token comment">#编号</span>
    bName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#图书名</span>
    price <span class="token keyword">DOUBLE</span><span class="token punctuation">,</span><span class="token comment">#价格</span>
    authorId  <span class="token keyword">INT</span><span class="token punctuation">,</span><span class="token comment">#作者编号</span>
    publishDate <span class="token keyword">DATETIME</span><span class="token comment">#出版日期</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">DESC</span> book<span class="token punctuation">;</span>

<span class="token comment">#案例：创建表author</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> author<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    au_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    nation <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">DESC</span> author<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-表的修改"><a href="#2-表的修改" class="headerlink" title="2.表的修改"></a>2.表的修改</h3><p><strong>语法</strong></p>
<p>alter table 表名 add|drop|modify|change column 列名 【列类型 约束】;</p>
<p>alter table 表名 add 列名 【first,after 列名】;</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#①修改列名</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> book CHANGE <span class="token keyword">COLUMN</span> publishdate pubDate <span class="token keyword">DATETIME</span><span class="token punctuation">;</span>

<span class="token comment">#②修改列的类型或约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> book <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> pubdate <span class="token keyword">TIMESTAMP</span><span class="token punctuation">;</span>

<span class="token comment">#③添加新列</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> author <span class="token keyword">ADD</span> <span class="token keyword">COLUMN</span> annual <span class="token keyword">DOUBLE</span><span class="token punctuation">;</span> 

<span class="token comment">#④删除列</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> book_author <span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span>  annual<span class="token punctuation">;</span>

<span class="token comment">#⑤修改表名</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> author <span class="token keyword">RENAME</span> <span class="token keyword">TO</span> book_author<span class="token punctuation">;</span>

<span class="token keyword">DESC</span> book<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-表的删除"><a href="#3-表的删除" class="headerlink" title="3.表的删除"></a>3.表的删除</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> book_author<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>

<span class="token comment">#通用的写法：</span>
<span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> 旧库名<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> 新库名<span class="token punctuation">;</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> 旧表名<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span>  表名<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-表的复制"><a href="#4-表的复制" class="headerlink" title="4.表的复制"></a>4.表的复制</h3><p><strong>1.仅仅复制表的结构</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> copy <span class="token operator">LIKE</span> author<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>2.复制表的结构+数据</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> copy2 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> author<span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>#只复制部分数据</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> copy3
<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>au_name
<span class="token keyword">FROM</span> author 
<span class="token keyword">WHERE</span> nation<span class="token operator">=</span><span class="token string">'中国'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>#仅仅复制某些字段</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> copy4 
<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>au_name
<span class="token keyword">FROM</span> author
<span class="token keyword">WHERE</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="第五章-常见的数据类型"><a href="#第五章-常见的数据类型" class="headerlink" title="第五章 常见的数据类型"></a>第五章 常见的数据类型</h1><p>数值型：</p>
<p>   整型</p>
<p>   小数：</p>
<p>​      定点数</p>
<p>​      浮点数</p>
<p>字符型：</p>
<p>   较短的文本：char、varchar</p>
<p>   较长的文本：text、blob（较长的二进制数据）</p>
<p>日期型：</p>
<h2 id="一、整型"><a href="#一、整型" class="headerlink" title="一、整型"></a><strong>一、整型</strong></h2><h3 id="分类：-1"><a href="#分类：-1" class="headerlink" title="分类："></a>分类：</h3><p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E6%95%B4%E5%9E%8B%E5%8F%98%E9%87%8F.png" alt="整型变量"></p>
<h3 id="特点：-1"><a href="#特点：-1" class="headerlink" title="特点："></a>特点：</h3><p>① 如果不设置无符号还是有符号，默认是有符号，如果想设置无符号，需要添加unsigned关键字</p>
<p>② 如果插入的数值超出了整型的范围,会报out of range异常，并且插入临界值</p>
<p>③ 如果不设置长度，会有默认的长度</p>
<p>长度代表了显示的最大宽度，如果不够会用0在左边填充，但必须搭配zerofill使用！</p>
<pre class="line-numbers language-SQL" data-language="SQL"><code class="language-SQL">#1.如何设置无符号和有符号
DROP TABLE IF EXISTS tab_int;
CREATE TABLE tab_int(
&nbsp; &nbsp; t1 INT(7) ZEROFILL,
&nbsp; &nbsp; t2 INT(7) ZEROFILL 
);


INSERT INTO tab_int VALUES(-123456);
INSERT INTO tab_int VALUES(-123456,-123456);
INSERT INTO tab_int VALUES(2147483648,4294967296);
INSERT INTO tab_int VALUES(123,123);

SELECT * FROM tab_int;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="二、小数"><a href="#二、小数" class="headerlink" title="二、小数"></a>二、小数</h2><h3 id="分类：-2"><a href="#分类：-2" class="headerlink" title="分类："></a>分类：</h3><p><strong>1.浮点型</strong></p>
<p>float(M,D)</p>
<p>double(M,D)</p>
<p><strong>2.定点型</strong></p>
<p>dec(M，D)</p>
<p>decimal(M,D)</p>
<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E5%B0%8F%E6%95%B0%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F.png" alt="小数类型变量"></p>
<h3 id="特点：-2"><a href="#特点：-2" class="headerlink" title="特点："></a><strong>特点：</strong></h3><p>①</p>
<p>M：整数部位+小数部位</p>
<p>D：小数部位</p>
<p>如果超过范围，则插入临界值</p>
<p>②</p>
<p>M和D都可以省略</p>
<p>如果是decimal，则M默认为10，D默认为0</p>
<p>如果是float和double，则会根据插入的数值的精度来决定精度</p>
<p>③定点型的精确度较高，如果要求插入数值的精度较高如货币运算等则考虑使用</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#测试M和D</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> tab_float<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tab_float<span class="token punctuation">(</span>
    f1 <span class="token keyword">FLOAT</span><span class="token punctuation">,</span>
    f2 <span class="token keyword">DOUBLE</span><span class="token punctuation">,</span>
    f3 <span class="token keyword">DECIMAL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> tab_float<span class="token punctuation">;</span>
<span class="token keyword">DESC</span> tab_float<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_float <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">123.4523</span><span class="token punctuation">,</span><span class="token number">123.4523</span><span class="token punctuation">,</span><span class="token number">123.4523</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_float <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">123.456</span><span class="token punctuation">,</span><span class="token number">123.456</span><span class="token punctuation">,</span><span class="token number">123.456</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_float <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">123.4</span><span class="token punctuation">,</span><span class="token number">123.4</span><span class="token punctuation">,</span><span class="token number">123.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_float <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1523.4</span><span class="token punctuation">,</span><span class="token number">1523.4</span><span class="token punctuation">,</span><span class="token number">1523.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#原则：所选择的类型越简单越好，能保存数值的类型越小越好</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="三、字符型"><a href="#三、字符型" class="headerlink" title="三、字符型"></a><strong>三、字符型</strong></h2><h3 id="较短的文本："><a href="#较短的文本：" class="headerlink" title="较短的文本："></a>较短的文本：</h3><p>char</p>
<p>varchar</p>
<h3 id="其他："><a href="#其他：" class="headerlink" title="其他："></a>其他：</h3><p>binary和varbinary用于保存较短的二进制</p>
<p>enum用于保存枚举（只能是里面的一项）</p>
<p>set用于保存集合 （可以是里面的几项）</p>
<h3 id="较长的文本："><a href="#较长的文本：" class="headerlink" title="较长的文本："></a>较长的文本：</h3><p>text</p>
<p>blob(较大的二进制)</p>
<h3 id="特点：-3"><a href="#特点：-3" class="headerlink" title="特点："></a>特点：</h3><p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E9%95%BF%E6%96%87%E6%9C%AC%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83.png" alt="长文本类型比较"></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tab_char<span class="token punctuation">(</span>
    c1 <span class="token keyword">ENUM</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_char <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_char <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_char <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_char <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'m'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_char <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> tab_set<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tab_set<span class="token punctuation">(</span>
    s1 <span class="token keyword">SET</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_set <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_set <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'A,B'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_set <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'a,c,d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="四、日期型"><a href="#四、日期型" class="headerlink" title="四、日期型"></a>四、日期型</h2><h3 id="分类：-3"><a href="#分类：-3" class="headerlink" title="分类："></a>分类：</h3><p>date只保存日期</p>
<p>time 只保存时间</p>
<p>year只保存年</p>
<p>datetime保存日期+时间</p>
<p>timestamp保存日期+时间</p>
<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F.png" alt="日期类型变量"></p>
<h3 id="特点：-4"><a href="#特点：-4" class="headerlink" title="特点："></a>特点：</h3><table>
<thead>
<tr>
<th align="center"></th>
<th align="center">字节</th>
<th align="center">范围</th>
<th align="center">时区等的影响</th>
</tr>
</thead>
<tbody><tr>
<td align="center">datetime</td>
<td align="center">8</td>
<td align="center">1000——9999</td>
<td align="center">不受</td>
</tr>
<tr>
<td align="center">timestamp</td>
<td align="center">4</td>
<td align="center">1970-2038</td>
<td align="center">受</td>
</tr>
</tbody></table>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tab_date<span class="token punctuation">(</span>
    t1 <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
    t2 <span class="token keyword">TIMESTAMP</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_date <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> tab_date<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'time_zone'</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> time_zone<span class="token operator">=</span><span class="token string">'+9:00'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="第六章-常见约束★"><a href="#第六章-常见约束★" class="headerlink" title="第六章 常见约束★"></a>第六章 <strong>常见约束</strong>★</h1><h2 id="含义：-2"><a href="#含义：-2" class="headerlink" title="含义："></a>含义：</h2><p>一种限制，用于限制表中的数据，为了保证表中的数据的准确和可靠性</p>
<h2 id="分类：六大约束"><a href="#分类：六大约束" class="headerlink" title="分类：六大约束"></a>分类：六大约束</h2><ol>
<li>NOT NULL：非空，用于保证该字段的值不能为空</li>
</ol>
<p>比如姓名、学号等</p>
<ol start="2">
<li>DEFAULT:默认，用于保证该字段有默认值</li>
</ol>
<p>比如性别</p>
<ol start="3">
<li>PRIMARY KEY:主键，用于保证该字段的值具有唯一性，并且非空</li>
</ol>
<p>比如学号、员工编号等</p>
<ol start="4">
<li>UNIQUE:唯一，用于保证该字段的值具有唯一性，可以为空</li>
</ol>
<p>比如座位号</p>
<p>Primary key:主键，用于保证该字段的值具有唯一性，并且非空</p>
<p>比如学号与员工编号</p>
<ol start="5">
<li>CHECK:检查约束【mysql中不支持】</li>
</ol>
<p>比如年龄、性别</p>
<ol start="6">
<li>FOREIGN KEY:外键，用于限制两个表的关系，用于保证该字段的值必须来自于主表的关联列的值（在从表添加外键约束，用于引用主表中某列的值）</li>
</ol>
<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/wps3.jpg">传统方式先删主表无法删除。</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#1.可以做级联删除</span>
<span class="token keyword">Alter</span> <span class="token keyword">table</span> stuinfo <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_stu_major <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>majorid<span class="token punctuation">)</span> <span class="token keyword">references</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">cascade</span> <span class="token punctuation">(</span>添加外键是加上最后三个单词<span class="token punctuation">)</span>就可以用上面的方法删除
<span class="token comment">#2.级联置空</span>
<span class="token keyword">Alter</span> <span class="token keyword">table</span> stuinfo <span class="token keyword">add</span> <span class="token keyword">constraint</span> fk_stu_major <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>majorid<span class="token punctuation">)</span> <span class="token keyword">references</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span> <span class="token punctuation">(</span>添加外键是加上最后三个单词<span class="token punctuation">)</span>就可以用上面的方法删除<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>比如学生表的专业编号，员工表的部门编号，员工表的工种编号</p>
<p><strong>添加约束的时机：</strong></p>
<p>​	1.创建表时</p>
<p>​	2.修改表时</p>
<p>​	添加数据之前</p>
<p> <strong>约束的添加分类：</strong></p>
<p>​	<strong>列级约束：</strong></p>
<p>​		六大约束语法上都支持，但外键约束没有效果</p>
<p>​	<strong>表级约束：</strong></p>
<p>​		除了非空、默认，其他的都支持</p>
<h3 id="主键和唯一的对比★："><a href="#主键和唯一的对比★：" class="headerlink" title="主键和唯一的对比★："></a>主键和唯一的对比★：</h3><p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E4%B8%BB%E9%94%AE%E5%92%8C%E5%94%AF%E4%B8%80%E7%9A%84%E5%AF%B9%E6%AF%94.png" alt="主键和唯一的对比"></p>
<p>外键：</p>
<p>​	1、要求在从表设置外键关系</p>
<p>​	2、从表的外键列的类型和主表（引用的那个表）的关联列的类型要求一致或兼容，名称无要求</p>
<p>​	3、主表的关联列必须是一个key（一般是主键或唯一）</p>
<p>​	4、插入数据时，先插入主表，再插入从表</p>
<p>​	删除数据时，先删除从表，再删除主表</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
    字段名 字段类型 列级约束<span class="token punctuation">,</span>
    字段名 字段类型<span class="token punctuation">,</span>
    表级约束
<span class="token punctuation">)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> students<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="一、创建表时添加约束"><a href="#一、创建表时添加约束" class="headerlink" title="一、创建表时添加约束"></a>一、创建表时添加约束</h3><p><strong>1.添加列级约束</strong></p>
<p>语法：</p>
<p>直接在字段名和类型后面追加 约束类型即可。</p>
<p>只支持：默认、非空、主键、唯一</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">USE</span> students<span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> stuinfo<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stuinfo<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span><span class="token comment">#主键</span>
    stuName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span><span class="token comment">#非空</span>
    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>gender<span class="token operator">=</span><span class="token string">'男'</span> <span class="token operator">OR</span> gender <span class="token operator">=</span><span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#检查</span>
    seat <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span><span class="token comment">#唯一</span>
    age <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span>  <span class="token number">18</span><span class="token punctuation">,</span><span class="token comment">#默认约束</span>
    majorId <span class="token keyword">INT</span> <span class="token keyword">REFERENCES</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token comment">#外键  major(id)我们称为主表id要为主键或唯一，一般是主键，要先有major（主表）才能插入majorId INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> major<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    majorName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#查看stuinfo中的所有索引，包括主键、外键、唯一</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> stuinfo<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>2.添加表级约束</strong></p>
<p>语法：在各个字段的最下面</p>
<p> 【constraint 约束名】 约束类型(字段名) </p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> stuinfo<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stuinfo<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    stuname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    seat <span class="token keyword">INT</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span><span class="token punctuation">,</span>
    majorid <span class="token keyword">INT</span><span class="token punctuation">,</span>
    
    <span class="token keyword">CONSTRAINT</span> pk <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#主键</span>
    <span class="token keyword">CONSTRAINT</span> uq <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>seat<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#唯一键</span>
    <span class="token keyword">CONSTRAINT</span> ck <span class="token keyword">CHECK</span><span class="token punctuation">(</span>gender <span class="token operator">=</span><span class="token string">'男'</span> <span class="token operator">OR</span> gender  <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">#检查</span>
    <span class="token keyword">CONSTRAINT</span> fk_stuinfo_major <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>majorid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token comment">#外键</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> stuinfo<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="一、通用的写法：★"><a href="#一、通用的写法：★" class="headerlink" title="一、通用的写法：★"></a>一、通用的写法：★</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> stuinfo<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    stuname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    sex <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">18</span><span class="token punctuation">,</span>
    seat <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>
    majorid <span class="token keyword">INT</span><span class="token punctuation">,</span>
    <span class="token keyword">CONSTRAINT</span> fk_stuinfo_major <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>majorid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="二、修改表时添加约束"><a href="#二、修改表时添加约束" class="headerlink" title="二、修改表时添加约束"></a>二、修改表时添加约束</h3><p>1、添加列级约束</p>
<p>alter table 表名 modify column 字段名 字段类型 新约束;</p>
<p>2、添加表级约束</p>
<p>alter table 表名 add 【constraint 约束名】 约束类型(字段名) 【外键的引用】;</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> stuinfo<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stuinfo<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    stuname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    seat <span class="token keyword">INT</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span><span class="token punctuation">,</span>
    majorid <span class="token keyword">INT</span>
<span class="token punctuation">)</span>
<span class="token keyword">DESC</span> stuinfo<span class="token punctuation">;</span>
<span class="token comment">#1.添加非空约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> stuname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
<span class="token comment">#2.添加默认约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> age <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token comment">#3.添加主键</span>
<span class="token comment">#①列级约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span>
<span class="token comment">#②表级约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#4.添加唯一</span>

<span class="token comment">#①列级约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> seat <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">;</span>
<span class="token comment">#②表级约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">ADD</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>seat<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#5.添加外键</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> fk_stuinfo_major <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>majorid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> major<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="三、修改表时删除约束"><a href="#三、修改表时删除约束" class="headerlink" title="三、修改表时删除约束"></a>三、修改表时删除约束</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#1.删除非空约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> stuname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">#2.删除默认约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> age <span class="token keyword">INT</span> <span class="token punctuation">;</span>

<span class="token comment">#3.删除主键</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">DROP</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span>

<span class="token comment">#4.删除唯一</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> seat<span class="token punctuation">;</span>

<span class="token comment">#5.删除外键</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> stuinfo <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> fk_stuinfo_major<span class="token punctuation">;</span>

<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> stuinfo<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="案列："><a href="#案列：" class="headerlink" title="案列："></a>案列：</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">
<span class="token comment">#1.向表emp2的id列中添加PRIMARY KEY约束（my_emp_id_pk）</span>

<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> emp2 <span class="token keyword">MODIFY</span> <span class="token keyword">COLUMN</span> id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> emp2 <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> my_emp_id_pk <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#2. 向表dept2的id列中添加PRIMARY KEY约束（my_dept_id_pk）</span>

<span class="token comment">#3. 向表emp2中添加列dept_id，并在其中定义FOREIGN KEY约束，与之相关联的列是dept2表中的id列。</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> emp2 <span class="token keyword">ADD</span> <span class="token keyword">COLUMN</span> dept_id <span class="token keyword">INT</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> emp2 <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> fk_emp2_dept2 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>dept_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> dept2<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%AF%B9%E6%AF%94.png" alt="约束的对比"></p>
<h3 id="四、标识列（自增长列）"><a href="#四、标识列（自增长列）" class="headerlink" title="四、标识列（自增长列）"></a><strong>四、标识列（自增长列）</strong></h3><p>又称为自增长列</p>
<p>含义：可以不用手动的插入值，系统提供默认的序列值</p>
<h4 id="特点：-5"><a href="#特点：-5" class="headerlink" title="特点："></a>特点：</h4><p>1、标识列必须和主键搭配吗？不一定，但要求是一个key（主键，外键，唯一等）</p>
<p>2、一个表可以有几个标识列？至多一个！</p>
<p>3、标识列的类型只能是数值型</p>
<p>4、标识列可以通过 SET auto_increment_increment=3;设置步长</p>
<p>可以通过 手动插入值，设置起始值 </p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#一、创建表时设置标识列</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> tab_identity<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tab_identity<span class="token punctuation">(</span>
    id <span class="token keyword">INT</span>  <span class="token punctuation">,</span>
    NAME <span class="token keyword">FLOAT</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    seat <span class="token keyword">INT</span> 
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> tab_identity<span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_identity<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'john'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tab_identity<span class="token punctuation">(</span>NAME<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'lucy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> tab_identity<span class="token punctuation">;</span>

<span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%auto_increment%'</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> auto_increment_increment<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>  

修改表时也能设置表标识列
<span class="token keyword">Alter</span> <span class="token keyword">table</span> tab_identity <span class="token keyword">modify</span> <span class="token keyword">column</span> id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">;</span>
修改表时也能删除表标识列
<span class="token keyword">Alter</span> <span class="token keyword">table</span> tab_identity <span class="token keyword">modify</span> <span class="token keyword">column</span> id <span class="token keyword">int</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="第七章-TCL事务控制语言"><a href="#第七章-TCL事务控制语言" class="headerlink" title="第七章 TCL事务控制语言"></a>第七章 TCL事务控制语言</h1><p>Transaction Control Language 事务控制语言</p>
<p>事务：</p>
<p>一个或一组sql语句组成一个执行单元，这个执行单元<strong>要么全部执行，要么全部不执行</strong>。</p>
<p>案例：转账</p>
<p>张三丰  1000</p>
<p>郭襄  1000</p>
<p>update 表 set 张三丰的余额=500 where name=’张三丰’</p>
<p>意外</p>
<p>update 表 set 郭襄的余额=1500 where name=’郭襄’</p>
<h2 id="事务的特性：ACID★"><a href="#事务的特性：ACID★" class="headerlink" title="事务的特性：ACID★"></a><strong>事务的特性：ACID</strong>★</h2><p>原子性atomicity：一个事务不可再分割，要么都执行要么都不执行</p>
<p>一致性consistency：一个事务执行会使数据从一个一致状态切换到另外一个一致状态</p>
<p>隔离性isolation：一个事务的执行不受其他事务的干扰</p>
<p>持久性Durability：一个事务一旦提交，则会永久的改变数据库的数据.</p>
<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7.jpg" alt="事务特性"></p>
<h2 id="事务的创建"><a href="#事务的创建" class="headerlink" title="事务的创建"></a>事务的创建</h2><p><strong>隐式事务：</strong>事务没有明显的开启和结束的标记</p>
<p>比如insert、update、delete语句</p>
<p>delete from 表 where id =1;</p>
<p><strong>显式事务：</strong>事务具有明显的开启和结束的标记</p>
<p>前提：必须先设置自动提交功能为禁用</p>
<p>set autocommit=0;</p>
<pre class="line-numbers language-none"><code class="language-none">步骤1：开启事务
set autocommit=0;
start transaction;可选的

步骤2：编写事务中的sql语句(select insert update delete)
语句1;
语句2;
...

步骤3：结束事务
commit;提交事务
rollback;回滚事务
(没有提交或者回滚之前只是保存在内存，没有读写到磁盘，遇到commit或rollback才写入磁盘)

savepoint 节点名;设置保存点（只能搭配rollback搭配）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>事务的隔离级别：×表示不会出现   √表示会出现</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody><tr>
<td>read uncommitted：</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>read committed：</td>
<td>×</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>repeatable read：</td>
<td>×</td>
<td>×</td>
<td>√</td>
</tr>
<tr>
<td>serializable</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
</tbody></table>
<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E4%BA%8B%E5%8A%A1%E5%B9%B6%E5%8F%91%E9%97%AE%E9%A2%98.jpg" alt="事务并发问题"></p>
<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB.jpg" alt="事务隔离级别"></p>
<p><strong>mysql中</strong>默认 第三个隔离级别 <strong>repeatable read</strong></p>
<p><strong>oracle中</strong>默认第二个隔离级别 <strong>read committed</strong></p>
<pre class="line-numbers language-none"><code class="language-none">查看隔离级别
select @@tx_isolation;

设置隔离级别
set session|global transaction isolation level 隔离级别;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>开启事务的语句;</p>
<p>update 表 set 张三丰的余额=500 where name=’张三丰’</p>
<p>update 表 set 郭襄的余额=1500 where name=’郭襄’ </p>
<p>结束事务的语句;</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'autocommit'</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> ENGINES<span class="token punctuation">;</span>

<span class="token comment">#1.演示事务的使用步骤</span>

<span class="token comment">#开启事务</span>
<span class="token keyword">SET</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
<span class="token comment">#编写一组事务的语句</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> balance <span class="token operator">=</span> <span class="token number">1000</span> <span class="token keyword">WHERE</span> username<span class="token operator">=</span><span class="token string">'张无忌'</span><span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> balance <span class="token operator">=</span> <span class="token number">1000</span> <span class="token keyword">WHERE</span> username<span class="token operator">=</span><span class="token string">'赵敏'</span><span class="token punctuation">;</span>

<span class="token comment">#结束事务</span>
<span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>
<span class="token comment">#commit;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>

<span class="token comment">#2.演示事务对于delete和truncate的处理的区别</span>

<span class="token keyword">SET</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>
<span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>

<span class="token comment">#3.演示savepoint 的使用</span>
<span class="token keyword">SET</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> account <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">SAVEPOINT</span> a<span class="token punctuation">;</span><span class="token comment">#设置保存点</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> account <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token number">28</span><span class="token punctuation">;</span>
<span class="token keyword">ROLLBACK</span> <span class="token keyword">TO</span> a<span class="token punctuation">;</span><span class="token comment">#回滚到保存点</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h1 id="第八章-视图"><a href="#第八章-视图" class="headerlink" title="第八章 视图"></a><strong>第八章 视图</strong></h1><p><strong>含义：虚拟表</strong>，和普通表一样使用</p>
<p>mysql5.1版本出现的新特性，是通过表动态生成的数据（临时的，没有保存数据）</p>
<p>比如：舞蹈班和普通班级的对比</p>
<p>视图的好处：</p>
<pre class="line-numbers language-none"><code class="language-none">重用sql语句
简化复杂的sql操作，不必知道它的查询细节
保护数据，提高安全性<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<p><img src="./images/loading.gif" data-original="https://geyangwen-images.oss-cn-hangzhou.aliyuncs.com/2022/%E8%A7%86%E5%9B%BE.jpg" alt="视图"></p>
<table>
<thead>
<tr>
<th></th>
<th>创建语法的关键字</th>
<th>是否实际占用物理空间</th>
<th>使用</th>
</tr>
</thead>
<tbody><tr>
<td>视图</td>
<td>create view</td>
<td>只是保存了sql逻辑</td>
<td>增删改查，只是一般不能增删改</td>
</tr>
<tr>
<td>表</td>
<td>create table</td>
<td>保存了数据</td>
<td>增删改查</td>
</tr>
</tbody></table>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：查询姓张的学生名和专业名</span>
<span class="token keyword">SELECT</span> stuname<span class="token punctuation">,</span>majorname
<span class="token keyword">FROM</span> stuinfo s
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> major m <span class="token keyword">ON</span> s<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>majorid<span class="token punctuation">`</span></span><span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>stuname<span class="token punctuation">`</span></span> <span class="token operator">LIKE</span> <span class="token string">'张%'</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> v1
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> stuname<span class="token punctuation">,</span>majorname
<span class="token keyword">FROM</span> stuinfo s
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> major m <span class="token keyword">ON</span> s<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>majorid<span class="token punctuation">`</span></span><span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> v1 <span class="token keyword">WHERE</span> stuname <span class="token operator">LIKE</span> <span class="token string">'张%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="一、创建视图"><a href="#一、创建视图" class="headerlink" title="一、创建视图"></a><strong>一、创建视图</strong></h2><p><strong>语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">view</span> 视图名
<span class="token keyword">as</span>
查询语句<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">USE</span> myemployees<span class="token punctuation">;</span>

<span class="token comment">#1.查询姓名中包含a字符的员工名、部门名和工种信息</span>
<span class="token comment">#①创建</span>
<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv1
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>job_title
<span class="token keyword">FROM</span> employees e
<span class="token keyword">JOIN</span> departments d <span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id  <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
<span class="token keyword">JOIN</span> jobs j <span class="token keyword">ON</span> j<span class="token punctuation">.</span>job_id  <span class="token operator">=</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">;</span>

<span class="token comment">#②使用</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv1 <span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'%a%'</span><span class="token punctuation">;</span>

<span class="token comment">#2.查询各部门的平均工资级别</span>
<span class="token comment">#①创建视图查看每个部门的平均工资</span>
<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv2
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> ag<span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span>

<span class="token comment">#②使用</span>
<span class="token keyword">SELECT</span> myv2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>ag<span class="token punctuation">`</span></span><span class="token punctuation">,</span>g<span class="token punctuation">.</span>grade_level
<span class="token keyword">FROM</span> myv2
<span class="token keyword">JOIN</span> job_grades g
<span class="token keyword">ON</span> myv2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>ag<span class="token punctuation">`</span></span> <span class="token operator">BETWEEN</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>lowest_sal<span class="token punctuation">`</span></span> <span class="token operator">AND</span> g<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>highest_sal<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">#3.查询平均工资最低的部门信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv2 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ag <span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">#4.查询平均工资最低的部门名和工资</span>
<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv3
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv2 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ag <span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> d<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>ag
<span class="token keyword">FROM</span> myv3 m
<span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> m<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="二、视图的修改"><a href="#二、视图的修改" class="headerlink" title="二、视图的修改"></a><strong>二、视图的修改</strong></h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#方式一：</span>
<span class="token comment">/*
create or replace view  视图名
as
查询语句;
*/</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv3 

<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv3
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>job_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">;</span>

<span class="token comment">#方式二：</span>
<span class="token comment">/*
语法：
alter view 视图名
as 
查询语句;
*/</span>
<span class="token keyword">ALTER</span> <span class="token keyword">VIEW</span> myv3
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="三、删除视图"><a href="#三、删除视图" class="headerlink" title="三、删除视图"></a><strong>三、删除视图</strong></h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#语法：drop view 视图名,视图名,...;</span>
<span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> emp_v1<span class="token punctuation">,</span>emp_v2<span class="token punctuation">,</span>myv3<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="四、查看视图"><a href="#四、查看视图" class="headerlink" title="四、查看视图"></a><strong>四、查看视图</strong></h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DESC</span> myv3<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv3<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="五、视图的更新"><a href="#五、视图的更新" class="headerlink" title="五、视图的更新"></a>五、视图的更新</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv1
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>email<span class="token punctuation">,</span>salary<span class="token operator">*</span><span class="token number">12</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">"annual salary"</span>
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv1
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>email
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv1<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#1.插入数据（会修改原始表）</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> myv1 <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'张飞'</span><span class="token punctuation">,</span><span class="token string">'zf@qq.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#2.修改数据（会修改原始表）</span>
<span class="token keyword">UPDATE</span> myv1 <span class="token keyword">SET</span> last_name <span class="token operator">=</span> <span class="token string">'张无忌'</span> <span class="token keyword">WHERE</span> last_name<span class="token operator">=</span><span class="token string">'张飞'</span><span class="token punctuation">;</span>
<span class="token comment">#3.删除数据（会修改原始表）</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> myv1 <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'张无忌'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>具备以下特点的视图不允许更新（视图里面基本不会去更新）</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#①包含以下关键字的sql语句：分组函数、distinct、group  by、having、union或者union all</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv1
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> m<span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv1<span class="token punctuation">;</span>
<span class="token comment">#更新</span>
<span class="token keyword">UPDATE</span> myv1 <span class="token keyword">SET</span> m<span class="token operator">=</span><span class="token number">9000</span> <span class="token keyword">WHERE</span> department_id<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">#②常量视图</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv2
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token string">'john'</span> NAME<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv2<span class="token punctuation">;</span>
<span class="token comment">#更新</span>
<span class="token keyword">UPDATE</span> myv2 <span class="token keyword">SET</span> NAME<span class="token operator">=</span><span class="token string">'lucy'</span><span class="token punctuation">;</span>

<span class="token comment">#③Select中包含子查询</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv3
<span class="token keyword">AS</span>

<span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">)</span> 最高工资
<span class="token keyword">FROM</span> departments<span class="token punctuation">;</span>
<span class="token comment">#更新</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv3<span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> myv3 <span class="token keyword">SET</span> 最高工资<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">;</span>

<span class="token comment">#④join</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv4
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e
<span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id  <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
<span class="token comment">#更新</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv4<span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> myv4 <span class="token keyword">SET</span> last_name  <span class="token operator">=</span> <span class="token string">'张飞'</span> <span class="token keyword">WHERE</span> last_name<span class="token operator">=</span><span class="token string">'Whalen'</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> myv4 <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'陈真'</span><span class="token punctuation">,</span><span class="token string">'xxxx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#⑤from一个不能更新的视图</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv5
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv3<span class="token punctuation">;</span>
<span class="token comment">#更新</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv5<span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> myv5 <span class="token keyword">SET</span> 最高工资<span class="token operator">=</span><span class="token number">10000</span> <span class="token keyword">WHERE</span> department_id<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">;</span>

<span class="token comment">#⑥where子句的子查询引用了from子句中的表</span>
<span class="token keyword">CREATE</span> <span class="token operator">OR</span> <span class="token keyword">REPLACE</span> <span class="token keyword">VIEW</span> myv6
<span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>email<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> employee_id <span class="token operator">IN</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  manager_id
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> manager_id <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#更新</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv6<span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> myv6 <span class="token keyword">SET</span> salary<span class="token operator">=</span><span class="token number">10000</span> <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'k_ing'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="第八章-变量"><a href="#第八章-变量" class="headerlink" title="第八章 变量"></a>第八章 变量</h1><p><strong>系统变量：</strong></p>
<pre><code>  **全局变量**
  
  **会话变量**
</code></pre>
<p><strong>自定义变量：</strong></p>
<pre><code>  **用户变量**
  
  **局部变量**
</code></pre>
<h2 id="一、系统变量"><a href="#一、系统变量" class="headerlink" title="一、系统变量"></a>一、系统变量</h2><p>说明：变量由系统定义，不是用户定义，属于服务器层面</p>
<p>注意：全局变量需要添加global关键字，会话变量需要添加session关键字，如果不写，默认会话级别</p>
<p>使用步骤：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>、查看所有系统变量
<span class="token keyword">show</span> <span class="token keyword">global</span><span class="token operator">|</span>【<span class="token keyword">session</span>】variables<span class="token punctuation">;</span>
<span class="token number">2</span>、查看满足条件的部分系统变量
<span class="token keyword">show</span> <span class="token keyword">global</span><span class="token operator">|</span>【<span class="token keyword">session</span>】 variables <span class="token operator">like</span> <span class="token string">'%char%'</span><span class="token punctuation">;</span>
<span class="token number">3</span>、查看指定的系统变量的值
<span class="token keyword">select</span> @<span class="token variable">@global</span><span class="token operator">|</span>【<span class="token keyword">session</span>】<span class="token punctuation">.</span>系统变量名<span class="token punctuation">;</span>
<span class="token number">4</span>、为某个系统变量赋值
方式一：
<span class="token keyword">set</span> <span class="token keyword">global</span><span class="token operator">|</span>【<span class="token keyword">session</span>】系统变量名<span class="token operator">=</span>值<span class="token punctuation">;</span>
方式二：
<span class="token keyword">set</span> @<span class="token variable">@global</span><span class="token operator">|</span>【<span class="token keyword">session</span>】系统变量名<span class="token operator">=</span>值<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-全局变量"><a href="#1-全局变量" class="headerlink" title="1. 全局变量"></a>1. 全局变量</h3><p><strong>作用域：针对于所有会话（连接）有效，但不能跨重启</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#①查看所有全局变量</span>
<span class="token keyword">SHOW</span> <span class="token keyword">GLOBAL</span> VARIABLES<span class="token punctuation">;</span>
<span class="token comment">#②查看满足条件的部分系统变量</span>
<span class="token keyword">SHOW</span> <span class="token keyword">GLOBAL</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%char%'</span><span class="token punctuation">;</span>
<span class="token comment">#③查看指定的系统变量的值</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@global.autocommit</span><span class="token punctuation">;</span>
<span class="token comment">#④为某个系统变量赋值</span>
<span class="token keyword">SET</span> @<span class="token variable">@global.autocommit</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="2-会话变量"><a href="#2-会话变量" class="headerlink" title="2. 会话变量"></a><strong>2. 会话变量</strong></h3><p><strong>作用域：针对于当前会话（连接）有效</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#①查看所有会话变量</span>
<span class="token keyword">SHOW</span> <span class="token keyword">SESSION</span> VARIABLES<span class="token punctuation">;</span>
<span class="token comment">#②查看满足条件的部分会话变量</span>
<span class="token keyword">SHOW</span> <span class="token keyword">SESSION</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'%char%'</span><span class="token punctuation">;</span>
<span class="token comment">#③查看指定的会话变量的值</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@autocommit</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@session.tx_isolation</span><span class="token punctuation">;</span>
<span class="token comment">#④为某个会话变量赋值</span>
<span class="token keyword">SET</span> @<span class="token variable">@session.tx_isolation</span><span class="token operator">=</span><span class="token string">'read-uncommitted'</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token keyword">SESSION</span> tx_isolation<span class="token operator">=</span><span class="token string">'read-committed'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="二、自定义变量"><a href="#二、自定义变量" class="headerlink" title="二、自定义变量"></a>二、自定义变量</h2><p>说明：变量由<strong>用户自定义</strong>，而不是系统提供的</p>
<p>使用步骤：</p>
<p>1、声明</p>
<p>2、赋值</p>
<p>3、使用（查看、比较、运算等）</p>
<h3 id="1-用户变量"><a href="#1-用户变量" class="headerlink" title="1.用户变量"></a>1.用户变量</h3><p><strong>作用域：针对于当前会话（连接）有效，作用域同于会话变量</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#赋值操作符：=或:=</span>
<span class="token comment">#①声明并初始化</span>
<span class="token keyword">SET</span> @变量名<span class="token operator">=</span>值<span class="token punctuation">;</span>
<span class="token keyword">SET</span> @变量名:<span class="token operator">=</span>值<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> @变量名:<span class="token operator">=</span>值<span class="token punctuation">;</span>

<span class="token comment">#②赋值（更新变量的值）</span>
<span class="token comment">#方式一：</span>
    <span class="token keyword">SET</span> @变量名<span class="token operator">=</span>值<span class="token punctuation">;</span>
    <span class="token keyword">SET</span> @变量名:<span class="token operator">=</span>值<span class="token punctuation">;</span>
    <span class="token keyword">SELECT</span> @变量名:<span class="token operator">=</span>值<span class="token punctuation">;</span>
<span class="token comment">#方式二：</span>
    <span class="token keyword">SELECT</span> 字段 <span class="token keyword">INTO</span> @变量名
    <span class="token keyword">FROM</span> 表<span class="token punctuation">;</span>
<span class="token comment">#③使用（查看变量的值）</span>
<span class="token keyword">SELECT</span> @变量名<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="2-局部变量"><a href="#2-局部变量" class="headerlink" title="2.局部变量"></a>2.局部变量</h3><p>作用域：仅仅在定义它的begin end块中有效</p>
<p>应用在 begin end中的<strong>第一句话</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#①声明</span>
<span class="token keyword">DECLARE</span> 变量名 类型<span class="token punctuation">;</span>
<span class="token keyword">DECLARE</span> 变量名 类型 【<span class="token keyword">DEFAULT</span> 值】<span class="token punctuation">;</span>

<span class="token comment">#②赋值（更新变量的值）</span>
<span class="token comment">#方式一：</span>
    <span class="token keyword">SET</span> 局部变量名<span class="token operator">=</span>值<span class="token punctuation">;</span>
    <span class="token keyword">SET</span> 局部变量名:<span class="token operator">=</span>值<span class="token punctuation">;</span>
    <span class="token keyword">SELECT</span> @局部变量名:<span class="token operator">=</span>值<span class="token punctuation">;</span>
<span class="token comment">#方式二：</span>
    <span class="token keyword">SELECT</span> 字段 <span class="token keyword">INTO</span> 具备变量名
    <span class="token keyword">FROM</span> 表<span class="token punctuation">;</span>
<span class="token comment">#③使用（查看变量的值）</span>
<span class="token keyword">SELECT</span> 局部变量名<span class="token punctuation">;</span>

<span class="token comment">#案例：声明两个变量，求和并打印</span>

<span class="token comment">#用户变量</span>
<span class="token keyword">SET</span> <span class="token variable">@m</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@n</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@sum</span><span class="token operator">=</span><span class="token variable">@m</span><span class="token operator">+</span><span class="token variable">@n</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token variable">@sum</span><span class="token punctuation">;</span>

<span class="token comment">#局部变量</span>
<span class="token keyword">DECLARE</span> m <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">DECLARE</span> n <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">DECLARE</span> SUM <span class="token keyword">INT</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> SUM<span class="token operator">=</span>m<span class="token operator">+</span>n<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> SUM<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>用户变量和局部变量的对比</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>作用域</th>
<th>定义位置</th>
<th>语法</th>
</tr>
</thead>
<tbody><tr>
<td>用户变量</td>
<td>当前会话</td>
<td>会话的任何地方</td>
<td>加@符号，不用指定类型</td>
</tr>
<tr>
<td>局部变量</td>
<td>定义它的BEGIN END中</td>
<td>BEGIN END的第一句话</td>
<td>一般不用加@,需要指定类型</td>
</tr>
</tbody></table>
<h1 id="第九章-存储过程和函数"><a href="#第九章-存储过程和函数" class="headerlink" title="第九章 存储过程和函数"></a><strong>第九章 存储过程和函数</strong></h1><p>存储过程和函数：类似于java中的方法</p>
<p>好处：</p>
<p>1、提高代码的重用性</p>
<p>2、简化操作</p>
<h2 id="一、存储过程"><a href="#一、存储过程" class="headerlink" title="一、存储过程"></a>一、存储过程</h2><p>含义：一组预先编译好的SQL语句的集合，理解成批处理语句</p>
<p>1、提高代码的重用性</p>
<p>2、简化操作</p>
<p>3、减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率</p>
<h3 id="一、创建语法"><a href="#一、创建语法" class="headerlink" title="一、创建语法"></a>一、创建语法</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> 存储过程名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    存储过程体（一组合法的<span class="token keyword">SQL</span>语句）
<span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>#注意：</strong></p>
<p>1、参数列表包含三部分</p>
<p>参数模式  参数名  参数类型</p>
<p>举例：</p>
<p>in stuname varchar(20)</p>
<p>参数模式：</p>
<p>in：该参数可以作为输入，也就是该参数需要调用方传入值</p>
<p>out：该参数可以作为输出，也就是该参数可以作为返回值</p>
<p>inout：该参数既可以作为输入又可以作为输出，也就是该参数既需要传入值，又可以返回值</p>
<p>2、如果存储过程体仅仅只有一句话，begin end可以省略</p>
<p>存储过程体中的每条sql语句的结尾要求必须加分号。</p>
<p>存储过程的结尾可以使用 delimiter 重新设置</p>
<p>语法：</p>
<p>delimiter 结束标记</p>
<p>案例：</p>
<p>delimiter $</p>
<h3 id="二、调用语法"><a href="#二、调用语法" class="headerlink" title="二、调用语法"></a><strong>二、调用语法</strong></h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CALL</span> 存储过程名<span class="token punctuation">(</span>实参列表<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#---------------------------案例演示-------------------------------</span>
<span class="token comment">#1.空参列表</span>
<span class="token comment">#案例：插入到admin表中五条记录</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> admin<span class="token punctuation">;</span>
<span class="token keyword">DELIMITER</span> $
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> admin<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token punctuation">)</span> 
    <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'john1'</span><span class="token punctuation">,</span><span class="token string">'0000'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'lily'</span><span class="token punctuation">,</span><span class="token string">'0000'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'rose'</span><span class="token punctuation">,</span><span class="token string">'0000'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'jack'</span><span class="token punctuation">,</span><span class="token string">'0000'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'tom'</span><span class="token punctuation">,</span><span class="token string">'0000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token comment">#调用</span>
<span class="token keyword">CALL</span> myp1<span class="token punctuation">(</span><span class="token punctuation">)</span>$

<span class="token comment">#2.创建带in模式参数的存储过程</span>
<span class="token comment">#案例1：创建存储过程实现 根据女神名，查询对应的男神信息</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp2<span class="token punctuation">(</span><span class="token operator">IN</span> beautyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> bo<span class="token punctuation">.</span><span class="token operator">*</span>
    <span class="token keyword">FROM</span> boys bo
    <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> beauty b <span class="token keyword">ON</span> bo<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>boyfriend_id
    <span class="token keyword">WHERE</span> b<span class="token punctuation">.</span>name<span class="token operator">=</span>beautyName<span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token comment">#调用</span>
<span class="token keyword">CALL</span> myp2<span class="token punctuation">(</span><span class="token string">'柳岩'</span><span class="token punctuation">)</span>$

<span class="token comment">#案例2 ：创建存储过程实现，用户是否登录成功</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp4<span class="token punctuation">(</span><span class="token operator">IN</span> username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">IN</span> PASSWORD <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> result <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">#声明并初始化</span>
    
    <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span> result<span class="token comment">#赋值</span>
    <span class="token keyword">FROM</span> admin
    <span class="token keyword">WHERE</span> admin<span class="token punctuation">.</span>username <span class="token operator">=</span> username
    <span class="token operator">AND</span> admin<span class="token punctuation">.</span>password <span class="token operator">=</span> PASSWORD<span class="token punctuation">;</span>
   <span class="token keyword">SELECT</span> <span class="token keyword">IF</span><span class="token punctuation">(</span>result<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'成功'</span><span class="token punctuation">,</span><span class="token string">'失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#使用</span>
<span class="token keyword">END</span> $

<span class="token comment">#调用</span>
<span class="token keyword">CALL</span> myp3<span class="token punctuation">(</span><span class="token string">'张飞'</span><span class="token punctuation">,</span><span class="token string">'8888'</span><span class="token punctuation">)</span>$

<span class="token comment">#3.创建out 模式参数的存储过程</span>
<span class="token comment">#案例1：根据输入的女神名，返回对应的男神名</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp6<span class="token punctuation">(</span><span class="token operator">IN</span> beautyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> boyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> bo<span class="token punctuation">.</span>boyname <span class="token keyword">INTO</span> boyname
    <span class="token keyword">FROM</span> boys bo
    <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span>
    beauty b <span class="token keyword">ON</span> b<span class="token punctuation">.</span>boyfriend_id <span class="token operator">=</span> bo<span class="token punctuation">.</span>id
    <span class="token keyword">WHERE</span> b<span class="token punctuation">.</span>name<span class="token operator">=</span>beautyName <span class="token punctuation">;</span>
<span class="token keyword">END</span> $

调用：<span class="token keyword">set</span> <span class="token variable">@bname$</span>
<span class="token keyword">Call</span> myp5<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>小昭<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token variable">@bname</span><span class="token punctuation">)</span>$

<span class="token comment">#案例2：根据输入的女神名，返回对应的男神名和魅力值</span>

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp7<span class="token punctuation">(</span><span class="token operator">IN</span> beautyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> boyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> usercp <span class="token keyword">INT</span><span class="token punctuation">)</span> 
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> boys<span class="token punctuation">.</span>boyname <span class="token punctuation">,</span>boys<span class="token punctuation">.</span>usercp <span class="token keyword">INTO</span> boyname<span class="token punctuation">,</span>usercp
    <span class="token keyword">FROM</span> boys 
    <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span>
    beauty b <span class="token keyword">ON</span> b<span class="token punctuation">.</span>boyfriend_id <span class="token operator">=</span> boys<span class="token punctuation">.</span>id
    <span class="token keyword">WHERE</span> b<span class="token punctuation">.</span>name<span class="token operator">=</span>beautyName <span class="token punctuation">;</span>
    
<span class="token keyword">END</span> $

<span class="token comment">#调用</span>
<span class="token keyword">CALL</span> myp7<span class="token punctuation">(</span><span class="token string">'小昭'</span><span class="token punctuation">,</span><span class="token variable">@name</span><span class="token punctuation">,</span><span class="token variable">@cp</span><span class="token punctuation">)</span>$
<span class="token keyword">SELECT</span> <span class="token variable">@name</span><span class="token punctuation">,</span><span class="token variable">@cp$</span>


<span class="token comment">#4.创建带inout模式参数的存储过程</span>
<span class="token comment">#案例1：传入a和b两个值，最终a和b都翻倍并返回</span>

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp8<span class="token punctuation">(</span><span class="token keyword">INOUT</span> a <span class="token keyword">INT</span> <span class="token punctuation">,</span><span class="token keyword">INOUT</span> b <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SET</span> a<span class="token operator">=</span>a<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">SET</span> b<span class="token operator">=</span>b<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token comment">#调用</span>
<span class="token keyword">SET</span> <span class="token variable">@m</span><span class="token operator">=</span><span class="token number">10</span>$
<span class="token keyword">SET</span> <span class="token variable">@n</span><span class="token operator">=</span><span class="token number">20</span>$
<span class="token keyword">CALL</span> myp8<span class="token punctuation">(</span><span class="token variable">@m</span><span class="token punctuation">,</span><span class="token variable">@n</span><span class="token punctuation">)</span>$
<span class="token keyword">SELECT</span> <span class="token variable">@m</span><span class="token punctuation">,</span><span class="token variable">@n$</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="三、删除存储过程"><a href="#三、删除存储过程" class="headerlink" title="三、删除存储过程"></a>三、删除存储过程</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#语法：drop procedure 存储过程名</span>
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> p1<span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> p2<span class="token punctuation">,</span>p3<span class="token punctuation">;</span><span class="token comment">#×</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="四、查看存储过程的信息"><a href="#四、查看存储过程的信息" class="headerlink" title="四、查看存储过程的信息"></a>四、查看存储过程的信息</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DESC</span> myp2<span class="token punctuation">;</span>×
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> myp2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="案列：-1"><a href="#案列：-1" class="headerlink" title="案列："></a>案列：</h2><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#一、创建存储过程实现传入用户名和密码，插入到admin表中</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_pro1<span class="token punctuation">(</span><span class="token operator">IN</span> username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">IN</span> loginPwd <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> admin<span class="token punctuation">(</span>admin<span class="token punctuation">.</span>username<span class="token punctuation">,</span>PASSWORD<span class="token punctuation">)</span>
    <span class="token keyword">VALUES</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>loginpwd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token comment">#二、创建存储过程实现传入女神编号，返回女神名称和女神电话</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_pro2<span class="token punctuation">(</span><span class="token operator">IN</span> id <span class="token keyword">INT</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> b<span class="token punctuation">.</span>name <span class="token punctuation">,</span>b<span class="token punctuation">.</span>phone <span class="token keyword">INTO</span> NAME<span class="token punctuation">,</span>phone
    <span class="token keyword">FROM</span> beauty b
    <span class="token keyword">WHERE</span> b<span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token comment">#三、创建存储存储过程或函数实现传入两个女神生日，返回大小</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_pro3<span class="token punctuation">(</span><span class="token operator">IN</span> birth1 <span class="token keyword">DATETIME</span><span class="token punctuation">,</span><span class="token operator">IN</span> birth2 <span class="token keyword">DATETIME</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> result <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> DATEDIFF<span class="token punctuation">(</span>birth1<span class="token punctuation">,</span>birth2<span class="token punctuation">)</span> <span class="token keyword">INTO</span> result<span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token comment">#四、创建存储过程或函数实现传入一个日期，格式化成xx年xx月xx日并返回</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_pro4<span class="token punctuation">(</span><span class="token operator">IN</span> mydate <span class="token keyword">DATETIME</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> strDate <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span>mydate<span class="token punctuation">,</span><span class="token string">'%y年%m月%d日'</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span> strDate<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">CALL</span> test_pro4<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">@str</span><span class="token punctuation">)</span>$
<span class="token keyword">SELECT</span> <span class="token variable">@str</span> $

<span class="token comment">#五、创建存储过程或函数实现传入女神名称，返回：女神 and 男神  格式的字符串</span>
如 传入 ：小昭
返回： 小昭 <span class="token operator">AND</span> 张无忌
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> test_pro5 $
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_pro5<span class="token punctuation">(</span><span class="token operator">IN</span> beautyName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> str <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>beautyName<span class="token punctuation">,</span><span class="token string">' and '</span><span class="token punctuation">,</span>IFNULL<span class="token punctuation">(</span>boyName<span class="token punctuation">,</span><span class="token string">'null'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span> str
    <span class="token keyword">FROM</span> boys bo
    <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> beauty b <span class="token keyword">ON</span> b<span class="token punctuation">.</span>boyfriend_id <span class="token operator">=</span> bo<span class="token punctuation">.</span>id
    <span class="token keyword">WHERE</span> b<span class="token punctuation">.</span>name<span class="token operator">=</span>beautyName<span class="token punctuation">;</span>
    <span class="token keyword">SET</span> str<span class="token operator">=</span>
<span class="token keyword">END</span> $

<span class="token keyword">CALL</span> test_pro5<span class="token punctuation">(</span><span class="token string">'柳岩'</span><span class="token punctuation">,</span><span class="token variable">@str</span><span class="token punctuation">)</span>$
<span class="token keyword">SELECT</span> <span class="token variable">@str</span> $

<span class="token comment">#六、创建存储过程或函数，根据传入的条目数和起始索引，查询beauty表的记录</span>
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> test_pro6$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_pro6<span class="token punctuation">(</span><span class="token operator">IN</span> startIndex <span class="token keyword">INT</span><span class="token punctuation">,</span><span class="token operator">IN</span> size <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> beauty <span class="token keyword">LIMIT</span> startIndex<span class="token punctuation">,</span>size<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">CALL</span> test_pro6<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="二、函数"><a href="#二、函数" class="headerlink" title="二、函数"></a>二、函数</h2><p>含义：一组预先编译好的SQL语句的集合，理解成批处理语句</p>
<p>1、提高代码的重用性</p>
<p>2、简化操作</p>
<p>3、减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率</p>
<p>区别：</p>
<p>存储过程：可以有0个返回，也可以有多个返回，适合做批量插入、批量更新</p>
<p>函数：有且仅有1 个返回，适合做处理数据后返回一个结果</p>
<h3 id="一、创建语法-1"><a href="#一、创建语法-1" class="headerlink" title="一、创建语法"></a>一、创建语法</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> 函数名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> 返回类型
<span class="token keyword">BEGIN</span>
    函数体
<span class="token keyword">END</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>注意：</p>
<pre class="line-numbers language-none"><code class="language-none">1.参数列表 包含两部分：
参数名 参数类型

2.函数体：肯定会有return语句，如果没有会报错
如果return语句没有放在函数体的最后也不报错，但不建议

return 值;
3.函数体中仅有一句话，则可以省略begin end

4.使用 delimiter语句设置结束标记<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="二、调用语法-1"><a href="#二、调用语法-1" class="headerlink" title="二、调用语法"></a>二、调用语法</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> 函数名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>
<span class="token comment">#------------------------------案例演示----------------------------</span>
<span class="token comment">#1.无参有返回</span>
<span class="token comment">#案例：返回公司的员工个数</span>
<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> myf1<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">INT</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> c <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">#定义局部变量</span>
    <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span> c<span class="token comment">#赋值</span>
    <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
    <span class="token keyword">RETURN</span> c<span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token keyword">SELECT</span> myf1<span class="token punctuation">(</span><span class="token punctuation">)</span>$
<span class="token comment">#2.有参有返回</span>
<span class="token comment">#案例1：根据员工名，返回它的工资</span>
<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> myf2<span class="token punctuation">(</span>empName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">DOUBLE</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">SET</span> <span class="token variable">@sal</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">#定义用户变量 </span>
    <span class="token keyword">SELECT</span> salary <span class="token keyword">INTO</span> <span class="token variable">@sal</span>   <span class="token comment">#赋值</span>
    <span class="token keyword">FROM</span> employees
    <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> empName<span class="token punctuation">;</span>
    
    <span class="token keyword">RETURN</span> <span class="token variable">@sal</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">SELECT</span> myf2<span class="token punctuation">(</span><span class="token string">'k_ing'</span><span class="token punctuation">)</span> $

<span class="token comment">#案例2：根据部门名，返回该部门的平均工资</span>
<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> myf3<span class="token punctuation">(</span>deptName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">DOUBLE</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> sal <span class="token keyword">DOUBLE</span> <span class="token punctuation">;</span>
    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">INTO</span> sal
    <span class="token keyword">FROM</span> employees e
    <span class="token keyword">JOIN</span> departments d <span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
    <span class="token keyword">WHERE</span> d<span class="token punctuation">.</span>department_name<span class="token operator">=</span>deptName<span class="token punctuation">;</span>
    <span class="token keyword">RETURN</span> sal<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">SELECT</span> myf3<span class="token punctuation">(</span><span class="token string">'IT'</span><span class="token punctuation">)</span>$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="三、查看函数"><a href="#三、查看函数" class="headerlink" title="三、查看函数"></a>三、查看函数</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> myf3<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h3 id="四、删除函数"><a href="#四、删除函数" class="headerlink" title="四、删除函数"></a><strong>四、删除函数</strong></h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">FUNCTION</span> myf3<span class="token punctuation">;</span>
<span class="token comment">#案例</span>
<span class="token comment">#一、创建函数，实现传入两个float，返回二者之和</span>

<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> test_fun1<span class="token punctuation">(</span>num1 <span class="token keyword">FLOAT</span><span class="token punctuation">,</span>num2 <span class="token keyword">FLOAT</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">FLOAT</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> SUM <span class="token keyword">FLOAT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">SET</span> SUM<span class="token operator">=</span>num1<span class="token operator">+</span>num2<span class="token punctuation">;</span>
    <span class="token keyword">RETURN</span> SUM<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">SELECT</span> test_fun1<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="第十章-流程控制结构"><a href="#第十章-流程控制结构" class="headerlink" title="第十章 流程控制结构"></a>第十章 流程控制结构</h1><h2 id="一、分支结构"><a href="#一、分支结构" class="headerlink" title="一、分支结构"></a>一、分支结构</h2><h3 id="1-if函数"><a href="#1-if函数" class="headerlink" title="1.if函数"></a>1.if函数</h3><p><strong>语法：if(条件,值1，值2)</strong></p>
<p><strong>功能：实现双分支</strong></p>
<p><strong>应用在begin end中或外面</strong></p>
<h3 id="2-case结构"><a href="#2-case结构" class="headerlink" title="2.case结构"></a>2.case结构</h3><p><strong>语法：</strong></p>
<p><strong>情况1：类似于switch</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">case</span> 变量或表达式
<span class="token keyword">when</span> 值<span class="token number">1</span> <span class="token keyword">then</span> 语句<span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">when</span> 值<span class="token number">2</span> <span class="token keyword">then</span> 语句<span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">else</span> 语句n<span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>情况2：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">case</span> 
<span class="token keyword">when</span> 条件<span class="token number">1</span> <span class="token keyword">then</span> 语句<span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">when</span> 条件<span class="token number">2</span> <span class="token keyword">then</span> 语句<span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">else</span> 语句n<span class="token punctuation">;</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>应用在begin end 中或外面</strong></p>
<p><strong>特点:</strong></p>
<p>可以作为表达式，嵌套在其他语句中使用，可以放在任何地方，BEGIN END中或BEGIN END的外面 </p>
<p>可以作为独立的语句去使用，只能放在BEGIN END中</p>
<p>如果WHEN中的值满足或条件成立，则执行对应的THEN后面的语句，并且结束CASEI如果都不满足，则执行ELSE中的语句或值</p>
<p>ELSE可以省略，如果ELSE省略了，并且所有WHEN条件都不满足，则返回NULL</p>
<h3 id="3-if结构"><a href="#3-if结构" class="headerlink" title="3.if结构"></a>3.if结构</h3><p><strong>语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">if</span> 条件<span class="token number">1</span> <span class="token keyword">then</span> 语句<span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">elseif</span> 条件<span class="token number">2</span> <span class="token keyword">then</span> 语句<span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">else</span> 语句n<span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>功能：类似于多重if</strong></p>
<p><strong>只能应用在begin end 中</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例1：创建函数，实现传入成绩，如果成绩&gt;90,返回A，如果成绩&gt;80,返回B，如果成绩&gt;60,返回C，否则返回D</span>
<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> test_if<span class="token punctuation">(</span>score <span class="token keyword">FLOAT</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">CHAR</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> ch <span class="token keyword">CHAR</span> <span class="token keyword">DEFAULT</span> <span class="token string">'A'</span><span class="token punctuation">;</span>
    <span class="token keyword">IF</span> score<span class="token operator">&gt;</span><span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> ch<span class="token operator">=</span><span class="token string">'A'</span><span class="token punctuation">;</span>
    <span class="token keyword">ELSEIF</span> score<span class="token operator">&gt;</span><span class="token number">80</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> ch<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">;</span>
    <span class="token keyword">ELSEIF</span> score<span class="token operator">&gt;</span><span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> ch<span class="token operator">=</span><span class="token string">'C'</span><span class="token punctuation">;</span>
    <span class="token keyword">ELSE</span> <span class="token keyword">SET</span> ch<span class="token operator">=</span><span class="token string">'D'</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
    <span class="token keyword">RETURN</span> ch<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">SELECT</span> test_if<span class="token punctuation">(</span><span class="token number">87</span><span class="token punctuation">)</span>$

<span class="token comment">#案例2：创建存储过程，如果工资&lt;2000,则删除，如果5000&gt;工资&gt;2000,则涨工资1000，否则涨工资500</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_if_pro<span class="token punctuation">(</span><span class="token operator">IN</span> sal <span class="token keyword">DOUBLE</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">IF</span> sal<span class="token operator">&lt;</span><span class="token number">2000</span> <span class="token keyword">THEN</span> <span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>salary<span class="token operator">=</span>sal<span class="token punctuation">;</span>
    <span class="token keyword">ELSEIF</span> sal<span class="token operator">&gt;=</span><span class="token number">2000</span> <span class="token operator">AND</span> sal<span class="token operator">&lt;</span><span class="token number">5000</span> <span class="token keyword">THEN</span> <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary<span class="token operator">=</span>salary<span class="token operator">+</span><span class="token number">1000</span> <span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span><span class="token operator">=</span>sal<span class="token punctuation">;</span>
    <span class="token keyword">ELSE</span> <span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary<span class="token operator">=</span>salary<span class="token operator">+</span><span class="token number">500</span> <span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span><span class="token operator">=</span>sal<span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
    
<span class="token keyword">END</span> $
<span class="token keyword">CALL</span> test_if_pro<span class="token punctuation">(</span><span class="token number">2100</span><span class="token punctuation">)</span>$

<span class="token comment">#案例1：创建函数，实现传入成绩，如果成绩&gt;90,返回A，如果成绩&gt;80,返回B，如果成绩&gt;60,返回C，否则返回D</span>
<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> test_case<span class="token punctuation">(</span>score <span class="token keyword">FLOAT</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">CHAR</span>
<span class="token keyword">BEGIN</span> 
    <span class="token keyword">DECLARE</span> ch <span class="token keyword">CHAR</span> <span class="token keyword">DEFAULT</span> <span class="token string">'A'</span><span class="token punctuation">;</span>
    
    <span class="token keyword">CASE</span> 
    <span class="token keyword">WHEN</span> score<span class="token operator">&gt;</span><span class="token number">90</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> ch<span class="token operator">=</span><span class="token string">'A'</span><span class="token punctuation">;</span>
    <span class="token keyword">WHEN</span> score<span class="token operator">&gt;</span><span class="token number">80</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> ch<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">;</span>
    <span class="token keyword">WHEN</span> score<span class="token operator">&gt;</span><span class="token number">60</span> <span class="token keyword">THEN</span> <span class="token keyword">SET</span> ch<span class="token operator">=</span><span class="token string">'C'</span><span class="token punctuation">;</span>
    <span class="token keyword">ELSE</span> <span class="token keyword">SET</span> ch<span class="token operator">=</span><span class="token string">'D'</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">CASE</span><span class="token punctuation">;</span>
    
    <span class="token keyword">RETURN</span> ch<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">SELECT</span> test_case<span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">)</span>$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="二、循环结构"><a href="#二、循环结构" class="headerlink" title="二、循环结构"></a>二、循环结构</h2><p>分类：</p>
<p>while、loop、repeat</p>
<p>循环控制：</p>
<p>iterate类似于 continue，继续，结束本次循环，继续下一次</p>
<p>leave 类似于 break，跳出，结束当前所在的循环</p>
<h3 id="1-while"><a href="#1-while" class="headerlink" title="1.while"></a>1.while</h3><p><strong>语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">【标签:】<span class="token keyword">while</span> 循环条件 <span class="token keyword">do</span>
  循环体<span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">while</span>【 标签】<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>联想：</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">while</span><span class="token punctuation">(</span>循环条件<span class="token punctuation">)</span><span class="token punctuation">{</span>
  循环体<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="2-loop"><a href="#2-loop" class="headerlink" title="2.loop"></a>2.loop</h3><p><strong>语法：</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">【标签:】<span class="token keyword">loop</span>
  循环体<span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">loop</span> 【标签】<span class="token punctuation">;</span>

可以用来模拟简单的死循环<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="3-repeat"><a href="#3-repeat" class="headerlink" title="3.repeat"></a>3.repeat</h3><p>语法：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">【标签：】<span class="token keyword">repeat</span>
  循环体<span class="token punctuation">;</span>
until 结束循环的条件
<span class="token keyword">end</span> <span class="token keyword">repeat</span> 【标签】<span class="token punctuation">;</span>

类似c<span class="token operator">+</span><span class="token operator">+</span>的<span class="token keyword">do</span>  <span class="token keyword">while</span>语句<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>1.没有添加循环控制语句</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：批量插入，根据次数插入到admin表中多条记录</span>
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> pro_while1$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> pro_while1<span class="token punctuation">(</span><span class="token operator">IN</span> insertCount <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">WHILE</span> i<span class="token operator">&lt;=</span>insertCount <span class="token keyword">DO</span>
        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> admin<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span>CONCAT<span class="token punctuation">(</span><span class="token string">'Rose'</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'666'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">WHILE</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token keyword">CALL</span> pro_while1<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>$
<span class="token comment">/*
int i=1;
while(i&lt;=insertcount){
    //插入
    i++;
}
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>2.添加leave语句</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：批量插入，根据次数插入到admin表中多条记录，如果次数&gt;20则停止</span>
<span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> admin$
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> test_while1$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_while1<span class="token punctuation">(</span><span class="token operator">IN</span> insertCount <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">;</span>
    a:<span class="token keyword">WHILE</span> i<span class="token operator">&lt;=</span>insertCount <span class="token keyword">DO</span>
        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> admin<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span>CONCAT<span class="token punctuation">(</span><span class="token string">'xiaohua'</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'0000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">IF</span> i<span class="token operator">&gt;=</span><span class="token number">20</span> <span class="token keyword">THEN</span> <span class="token keyword">LEAVE</span> a<span class="token punctuation">;</span>
        <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
        <span class="token keyword">SET</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">END</span> <span class="token keyword">WHILE</span> a<span class="token punctuation">;</span>
<span class="token keyword">END</span> $

<span class="token keyword">CALL</span> test_while1<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>3.添加iterate语句</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">#案例：批量插入，根据次数插入到admin表中多条记录，只插入偶数次</span>
<span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> admin$
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> test_while1$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_while1<span class="token punctuation">(</span><span class="token operator">IN</span> insertCount <span class="token keyword">INT</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
    a:<span class="token keyword">WHILE</span> i<span class="token operator">&lt;=</span>insertCount <span class="token keyword">DO</span>
        <span class="token keyword">SET</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">IF</span> <span class="token function">MOD</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token keyword">ITERATE</span> a<span class="token punctuation">;</span>
        <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
        
        <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> admin<span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span>CONCAT<span class="token punctuation">(</span><span class="token string">'xiaohua'</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'0000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token keyword">END</span> <span class="token keyword">WHILE</span> a<span class="token punctuation">;</span>
<span class="token keyword">END</span> $
<span class="token keyword">CALL</span> test_while1<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>$

<span class="token comment">/*
int i=0;
while(i&lt;=insertCount){
    i++;
    if(i%2==0){
        continue;
    }
    插入
}
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">葛杨文</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://gitee.com/ge-yangwen/geyangwen.gitee.io/2022/110216773.html">https://gitee.com/ge-yangwen/geyangwen.gitee.io/2022/110216773.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">葛杨文</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/mysql/">
                                    <span class="chip bg-color">mysql</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="./images/loading.gif" data-original="https://blog-accelerated.oss-cn-hangzhou.aliyuncs.com/source/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="./images/loading.gif" data-original="https://blog-accelerated.oss-cn-hangzhou.aliyuncs.com/source/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: '2GHAwHTGn8XLUAd7QB3o7e4c-gzGzoHsz',
        appKey: '4EmLXaoemlw5MQWjAC60IbU8',
        notify: '' === 'true',
        verify: '' === 'true',
        visitor: '' === 'true',
        avatar: 'monsterid',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: '昵称填写qq可以显示qq头像和昵称哦~'
    });
</script>

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/110338091.html">
                    <div class="card-image">
                        
                        
                        <img src="./images/loading.gif" data-original="https://blog-accelerated.oss-cn-hangzhou.aliyuncs.com/source/medias/featureimages/10.jpg" class="responsive-img" alt="mysql学习笔记中级">
                        
                        <span class="card-title">mysql学习笔记中级</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-11-03
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/mysql%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-category">
                                    mysql学习笔记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/mysql/">
                        <span class="chip bg-color">mysql</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/10273975.html">
                    <div class="card-image">
                        
                        
                        <img src="./images/loading.gif" data-original="https://blog-accelerated.oss-cn-hangzhou.aliyuncs.com/source/medias/featureimages/18.jpg" class="responsive-img" alt="hexo的个性化配置">
                        
                        <span class="card-title">hexo的个性化配置</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-10-27
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/" class="post-category">
                                    软件安装与配置
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/hexo/">
                        <span class="chip bg-color">hexo</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1,h2, h3, h4,h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1,h2, h3, h4,h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022-2024</span>
            
            <span id="year">2022</span>
            <a href="/about" target="_blank">葛杨文</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">496.5k</span>&nbsp;字
            
            
            
            
            
            <!-- 修改不蒜子初始化计数 -->
                  
                <span id="busuanzi_container_site_pv" style='display:none'></span>
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
            
            
            
            
                <span id="busuanzi_container_site_uv" style='display:none'></span>
                    人次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                
                                    
            <br>
            <!-- 增加建站时间（下面这句话） -->
            <span id="sitetime"></span>

            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Geyangwen" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:3057318483@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=3057318483" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 3057318483" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>

<!-- 增加建站时间 -->
<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2022, 10, 25, 00, 00, 00); //北京时间2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "小破站已运行 " +diffYears+" 年 "+diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>

<!-- 修改不蒜子初始化计数 -->
<script>
    $(document).ready(function () {

        var int = setInterval(fixCount, 50);  // 50ms周期检测函数
        var pvcountOffset = 80000;  // 初始化首次数据
        var uvcountOffset = 20000;

        function fixCount() {
            if (document.getElementById("busuanzi_container_site_pv").style.display != "none") {
                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset);
                clearInterval(int);
            }
            if ($("#busuanzi_container_site_pv").css("display") != "none") {
                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据 
                clearInterval(int); // 停止检测
            }
        }
    });
</script>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    
        <!-- 添加死鬼你来了的小顽皮 -->
    <script type="text/javascript">
        var OriginTitile = document.title,
            st;
        document.addEventListener("visibilitychange", function () {
            document.hidden ? (document.title = "客官别走呀！", clearTimeout(st)) : (document.title =
                "(๑•̀ㅂ•́)死鬼你来了", st = setTimeout(function () {
                    document.title = OriginTitile
                }, 3e3))
        })
    </script>
    <!-- 樱花特效 -->
    <!-- <script type="text/javascript">
        //只在桌面版网页启用特效
        var windowWidth = $(window).width();
        if (windowWidth > 768) {
            document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>');
        }
    </script> -->
    

    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    


        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,c=(r.imageLazyLoadSetting.preloadRatio,n());function n(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=n());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight+240||document.documentElement.clientHeight+240)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function a(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",a),r.addEventListener("resize",a),r.addEventListener("orientationchange",a)}(this);</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>
